function alterImages(){$("img.svg").each(function(){var a=$(this),b=a.attr("id"),c=a.attr("class"),d=a.attr("src");svgs[d]?a.replaceWith(svgs[d]):$.get(d,function(e){var f=jQuery(e).find("svg");void 0!==b&&(f=f.attr("id",b)),void 0!==c&&(f=f.attr("class",c+" replaced-svg")),f=f.removeAttr("xmlns:a"),!f.attr("viewBox")&&f.attr("height")&&f.attr("width")&&f.attr("viewBox","0 0 "+f.attr("height")+" "+f.attr("width")),svgs[d]=f,a.replaceWith(f)},"xml")})}function expandtextarea(){var a=$("#messageInput");""!=$("#messageInput").val().trim()?$(".send-bttn").show():($(".send-bttn").hide(),$("#messageInput").css("height","55px")),setTimeout(function(){var b=a.prop("scrollHeight");b<150&&b>55?(a.css("height",b+"px"),b+55>100&&$(".trilyo-chat-body").css("bottom",b+55+"px"),$("#messageInput").css("overflow-y","hidden")):$("#messageInput").css("overflow-y","auto")},0)}function storageAvailable(a){try{var b=window[a],c="__storage_test__";return b.setItem(c,c),b.removeItem(c),!0}catch(a){return!1}}function linkify(a){var b,c,d,e;if(a.indexOf("linkifyTrilyo")>-1)return a;if(a.indexOf("<a")>-1){var f=a.match(/<a.+<\/a>/gim);if(f&&f.length>0)for(var g in f){var h=$(f[g]);h.attr("linkifyTrilyo",""),h.attr("target","_blank"),a=a.replace(f[g],h[0].outerHTML)}return a}c=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim;var i=a.match(c);if(i&&i.length>0){b=a;for(var j in i)b=b.replace(i[j],'<a href="'+serverURL+"redirector?account_id="+trilyoBearer+"&sender_id="+senderID+"&source_id=2&save_chat_history=true&redirect_url="+encodeURIComponent(i[j])+'" linkifyTrilyo target="_blank">'+i[j]+"</a>"),-1==b.indexOf("linkifyTrilyo")&&(d=/(^|[^\/])(www\.[\S]+(\b|$))/gim,b=b.replace(d,'$1<a href="http://$2" linkifyTrilyo target="_blank">$2</a>'))}else b=a;e=/(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim;var k=b.match(e);if(k&&k.length>0)for(var j in k)b=b.replace(k[j],'<a href="'+serverURL+"redirector?account_id="+trilyoBearer+"&sender_id="+senderID+"&source_id=2&save_chat_history=true&redirect_url=mailto:"+k[j]+'" linkifyTrilyo>'+k[j]+"</a>");return b}function boldify(a){var b,c,a=a+"";return c=/(\*([^*]+)\*)/gim,b=a.replace(c,"<strong>$2</strong>"),b=b.replace(/(?:\r\n|\r|\n)/gim,"<br />")}function getIpInfo(a){$.get("//ipinfo.io",function(){},"jsonp").always(function(b){a(b)})}function parseStringPath(a,b){function c(a,b){return b.indexOf("[")>-1?b.replace(/\]/gi,"").split("[").reduce(c,a):a[b]}return b.split(".").reduce(c,a)}function resolveUrl(a,b,c,d,e,f,g){function h(a,b,c){var b=i(b,c);switch(a){case"Date":var d=b.split(",");d[1]=d[1].replace(/YYYY/gi,new Date(d[0].trim()).getFullYear()),d[1]=d[1].replace(/YY/gi,new Date(d[0].trim()).getYear()),d[1]=d[1].replace(/MMMM/gi,k(new Date(d[0].trim()).getMonth())),d[1]=d[1].replace(/MMM/gi,j(new Date(d[0].trim()).getMonth()));var e=new Date(d[0].trim()).getMonth()+1;e<10&&(e="0"+e),d[1]=d[1].replace(/MM/gi,e);var f=new Date(d[0].trim()).getDate();f<10&&(f="0"+f),d[1]=d[1].replace(/DD/gi,f),b=d[1].replace(/["']+/gi,"")}return b}function i(a,b){for(var c in b)a=a.replace("<"+c+">",b[c]);return a}function j(a){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a]}function k(a){return["January","February","March","April","May","June","July","August","Septempber","October","November","December"][a]}e&&(e=resolveUrl(JSON.stringify(e),b));var l={checkIn:b.checkin,checkOut:b.checkout,city:b.city,hotel:b.hotel,adults:b.adults,children:b.children,numRooms:b.numRooms,traveling:b.traveling_with},m=a.match(/~~([^~]+)~~/gi);if(m)for(var n=0;n<m.length;n++){var o=m[n].replace(/~~/gi,"").replace(")",""),p=o.split("("),q=p[0],r=p[1];a=a.replace(m[n],h(q,r,l))}return c&&"post"==c.toLowerCase()?new Promise(function(b,c){$.ajax({url:a,type:"POST",data:e,dataType:"json",contentType:"application/json; charset=utf-8",crossOrigin:!0,success:function(a){b(parseStringPath(a,g.url))}})}):a}function maxK1(a,b){for(var c=[],d=0,e=1e8,f=1e-8;b>0;){for(var g=0;g<a.length;g++)a[g]>f&&a[g]<e&&(f=a[g],d=g);e=f,f=1e-8,d!==c[c.length-1]&&c.push(d),b--}return c}function disp(a){var b=document.getElementById("messageInput"),c=document.getElementById("suggestions"),d=document.getElementById("suggestionPills"),e=document.getElementById("suggestionSentence"),f=document.getElementsByTagName("textarea")[0],g=document.getElementsByClassName("suggestionPill");if(13===a.keyCode&&(c.style.display="none",corrected=""),inserted)if(38===a.keyCode||40===a.keyCode){38===a.keyCode?activPillIndex>0?activPillIndex-=1:activPillIndex=g.length-1:40===a.keyCode&&(activPillIndex<g.length?activPillIndex+=1:activPillIndex=0),b.value=g[activPillIndex].innerText.split("\n")[0],currentInserted=g[activPillIndex].innerText.split("\n")[0];for(var h=0;h<g.length;h++)h===activPillIndex?g[h].classList.add("activPill"):g[h].classList.remove("activPill")}else 8===a.keyCode?(a.preventDefault(),b.value=b.value.slice(0,b.value.indexOf(currentInserted)-1),d.innerText="",c.style.display="none",d.style.display="none",corrected="",f.classList.remove("remove_box_shadow"),inserted=!1,activPillIndex=-2,currentInserted="",b.removeEventListener("keydown",disp)):(inserted=!1,activPillIndex=-2,currentInserted="",d.innerText="",c.style.display="none",d.style.display="none",corrected="",f.classList.remove("remove_box_shadow"),b.removeEventListener("keydown",disp));else if(38===a.keyCode||40===a.keyCode){a.preventDefault(),e.innerText="",38===a.keyCode?(activPillIndex=g.length,activPillIndex>0?activPillIndex-=1:activPillIndex=g.length-1):40===a.keyCode&&(activPillIndex=-1,activPillIndex<4?activPillIndex+=1:activPillIndex=0),currentInserted,b.value=g[activPillIndex].innerText.split("\n")[0],currentInserted=g[activPillIndex].innerText.split("\n")[0];for(var h=0;h<g.length;h++)h===activPillIndex?g[h].classList.add("activPill"):g[h].classList.remove("activPill");inserted=!0}else if(39===a.keyCode){var i=b.value.length+1;b.value=b.value.trim(),b.value+=" "+e.innerText,b.focus(),b.selectionEnd=i+e.innerText.length,currentInserted=e.innerText,inserted=!0,e.innerText="",activPillIndex=-1}else inserted=!1,activPillIndex=-2,currentInserted="",c.style.display="none",corrected="",f.classList.remove("remove_box_shadow"),b.removeEventListener("keydown",disp)}function getXY(a,b){const c=a.offsetLeft,d=a.offsetTop,e=document.createElement("div"),f=getComputedStyle(a);for(var g in f)e.style[g]=f[g];const h=".",i="INPUT"===a.tagName?a.value.replace(/ /g,h):a.value,j=i.substr(0,b);e.textContent=j,"TEXTAREA"===a.tagName&&(e.style.height="auto"),"INPUT"===a.tagName&&(e.style.width="auto");const k=document.createElement("span");k.textContent=i.substr(b)||".",e.appendChild(k),document.body.appendChild(e);const l=k.offsetLeft,m=k.offsetTop;return document.body.removeChild(e),{x:c+l-1,y:d+m+20}}function suggestSentence(a){var b=document.getElementById("messageInput"),c=document.getElementById("suggestions"),d=document.getElementById("suggestionSentence"),e=document.getElementById("suggestionPills"),f=document.getElementsByTagName("textarea")[0];b.removeEventListener("keydown",disp),inserted=!1,activPillIndex=-2,currentInserted="",d.innerText="",e.innerText="",b.value.split(" ").length>1&&fetch("/getSuggestions/"+trilyoBearer,{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify({query:a.toLowerCase()})}).then(function(a){return a.json()}).then(function(g){e.innerText="";var h=g.sentences,i=g.scores,j=g.sentence,k=j;if(h=h.filter(function(a){return void 0!==a}),h.length>0){var l=maxK1(i,4);h=l.map(function(a){return h[a]}),h=h.filter(function(a){return void 0!==a}),e.style.display="flex",f.classList.add("remove_box_shadow")}for(var m=1;m<h.length;m++){var n=document.createElement("div"),o=document.createElement("p");n.className="suggestionPill",n.addEventListener("click",function(){clear("pill",this)}),o.className="pillTxt",o.innerText=h[m],n.appendChild(o),e.appendChild(n)}var p=[],q=[];j=j?j.split(" ").filter(function(b){return null===a.match(b.toLowerCase().replace(/[^\w\s]/,""))}):null;var r=b.value.toLowerCase().split(" ");if(r.pop(),j){r.map(function(a){var b=0;j.map(function(c){null!==c.match(a)&&"a"!==a&&"i"!==a&&JaroWinklerDistance(a,c)>.85&&(b=1,p.push(c))}),0===b&&" "!==a&&""!==a&&p.push(a)});var s=!1;null!==k.match(p.join(" "))&&0==k.indexOf(p.join(" "))?(s=!0,k=k.substring(k.indexOf(p.join(" "))),j=k.split(" ").filter(function(a){return null===p.join(" ").match(a.toLowerCase().replace(/[^\w\s]/,""))})):h.map(function(a){null!==a.match(p.join(" "))&&0==a.indexOf(p.join(" "))&&(a=a.substring(a.indexOf(p.join(" "))),s=!0,j=a.split(" ").filter(function(a){return null===p.join(" ").match(a.toLowerCase().replace(/[^\w\s]/,""))}))}),s||(j=[]),j.map(function(a){-1===p.indexOf(a)&&q.push(a)}),corrected=Capitalize(p.join(" "));var t=b.value.length;b.selectionEnd=t;var u=getXY(b,b.value.length);c.style.position="relative",c.style.left=u.x+"px",c.style.top=u.y+"px",d.innerText=q.join(" "),0!==q.length&&(d.style.display="block"),c.style.display="flex",b.addEventListener("keydown",disp)}}).catch(function(a){console.error(a)})}function clear(a,b){var c="";if("sentence"===a)c=document.getElementById("suggestionSentence").innerText;else for(var d=document.getElementsByClassName("suggestionPill"),e=0;e<d.length;e++)d[e]===b&&(c=d[e].innerText.trim());document.getElementById("messageInput").value=c,document.getElementById("suggestionPills").innerHTML="",document.getElementById("suggestionSentence").innerText="",document.getElementById("suggestions").style.display="none"}function inIframe(){try{return window.self!==window.top}catch(a){return!0}}function emitEvent(a,b,c){var d=new XMLHttpRequest,e="https://www.google-analytics.com/collect?v=1&tid=UA-75032329-5&ni=1&cid=<%SENDERID%>&t=event&ec="+a+"&ea="+b+"&el="+c;d.open("GET",e),d.onreadystatechange=function(){d.readyState==XMLHttpRequest.DONE&&(200==d.status||d.status)},d.send()}var cl=[];!function(){if("undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]"));else{console.log("Promise polyfill");var a=document.createElement("script");a.src="https://cdnjs.cloudflare.com/ajax/libs/bluebird/3.3.5/bluebird.min.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}}();var idleTime2=0,corrected="",totalOnlineUsers=0,livewireShown=!1,svgs={},chatOpened=!1;$(document).ready(function(){alterImages(),$("#messageInput").keyup(function(){$(this).val().length>0&&$(this).val().length<3&&$(this).val($(this).val().charAt(0).toUpperCase()+$(this).val().substr(1))}),$("#closeOptin").click(function(){$(".adMessage").hide(),fbLoaded=!1}),$("#trilyo_persitent_menu").menu({select:function(a,b){}}),$(document).on("mouseenter",".suggestionPill",function(){$(".suggestionPill").removeClass("activPill"),$(this).addClass("activPill")})}),$(document).on("keydown","#messageInput",function(){expandtextarea()}),$.datepicker._gotoToday=function(a){$(".datepicker").datepicker("setDate",new Date).datepicker("hide").blur()};var UID="trilyo-id-"+trilyoBearer,CID="trilyo-chat-history-"+trilyoBearer,AID="trilyo-chat-history-archive-"+trilyoBearer,UDID="trilyo-user-data-"+trilyoBearer,QID="trilyo-quickReply-"+trilyoBearer,RID="trilyo-registered-"+trilyoBearer,SID="trilyo-started-"+trilyoBearer,LID="trilyo-lead-"+trilyoBearer,LoID="trilyo-login-"+trilyoBearer,serverURL=baseUrl.replace("webapp/webhook",""),url=window.location!=window.parent.location?document.referrer:document.location.href;ref&&""!=ref&&"<%REF%>"!=ref||(ref="Direct");var subtractDays=function(a,b){var c=new Date(a.getTime());return c.setDate(a.getDate()-b),c};angular.module("clientMainApp",["ui-rangeSlider"]).controller("clientController",["$scope","$http","$sce","$location","$timeout","$filter",function(a,b,c,d,e,f){function g(a,b,c){alert("Error: The Geolocation service failed")}function h(){if(a.scrolling)a.processStarted||(a.processStarted=!0,e(function(){for(var b in a.que)a.que[b]&&a.que[b].processed&&a.que.splice(b,1);a.processStarted=!1,h()},1100));else for(var b in a.que)if(a.que[b]&&!a.que[b].processed){i(a.que[b].data),a.que[b].processed=!0,e(function(){h(),a.processStarted=!1},500);break}$("#messageInput").focus()}function i(b,d,f){$(".seen-chat").css("display","none");var g;if(void 0!=b.quickReply){g="quick-reply";for(var h in b.quickReply)if(b.quickReply[h].title.length>20){g="list-reply";break}}if(b.multiselect&&(g="list-reply-multi"),void 0!=b.text){if("info~~agent~~left"==b.text&&a.agent)return o.push({chatInputMsg:"",chatOutputMsg:"--------- "+a.agent+" left -------- ",senderId:a.userId,type:"info"}),void(a.agent=null);if(prepend="",b.agent&&(a.agent&&a.agent==b.agent||o.push({chatInputMsg:"",chatOutputMsg:"--------- "+b.agent+" joined -------- ",senderId:a.userId,type:"info"}),a.agent=b.agent,prepend='<div class="agent">'+b.agent+"</div>"),b.text=linkify(boldify(b.text)),d||parent.postMessage({type:"general",message:b.text},"*"),!d&&b.welcome&&parent.postMessage({type:"welcome",message:b.text},"*"),g&&"list-reply"!=g&&"list-reply-multi"!=g||!g){var i={chatInputMsg:"",chatOutputMsg:c.trustAsHtml(prepend+b.text),senderId:a.userId,type:b.input&&b.input.replyTo||!b.input?"text":"abc",plainText:b.text};b.input&&b.input.replyTo&&(i.chatReplyMsg=c.trustAsHtml(b.input.replyTo)),o.length,(0==o.length||o.length>0&&o[o.length-1].plainText!=i.plainText)&&(b.welcome?0==o.length?o[0]=i:o[o.length-1]=i:o.push(i))}}if(void 0!=b.carousel&&o.push({chatInputMsg:"",chatOutputMsg:b.carousel,senderId:a.userId,type:"carousel"}),void 0!=b.list&&o.push({chatInputMsg:"",chatOutputMsg:b.list,senderId:a.userId,type:"list"}),void 0!=b.youTube&&(d&&(b.youTube=b.youTube.replace("&autoplay=1","")),o.push({chatInputMsg:"",chatOutputMsg:b.youTube,senderId:a.userId,type:"youTube"})),void 0!=b.buttons&&o.push({chatInputMsg:"",chatOutputMsg:b.buttons,senderId:a.userId,type:"buttons"}),void 0!=b.quickReply){var k={};"list-reply"==g||"list-reply-multi"==g?(k.text=c.trustAsHtml(b.text),k.opts=b.quickReply,o.push({chatInputMsg:"",chatOutputMsg:c.trustAsHtml(b.text),senderId:a.userId,type:"abc",plainText:b.text})):k=b.quickReply,o.push({chatInputMsg:"",chatOutputMsg:k,senderId:a.userId,type:g,plainText:b.text}),a.removeQuickReply=!1}if(void 0!=b.bits&&(a.bits=b.message.bits,a.$$phase||a.$apply()),b.takePermission&&parent.postMessage("askPermission","*"),a.nextMessageType=null,void 0!=b.input){if(b.input instanceof Object);else switch(b.input.toLowerCase()){case"email":a.removeEmailField=!1,a.nextMessageType="email";break;case"phone":a.removePhoneField=!1,a.nextMessageType="phone",b.init&&b.init.initCountry&&(a.form.initCountry=b.init.initCountry),a.phoneObj||(a.phoneObj={});break;case"phonewhatsapp":a.removePhoneField=!1,a.nextMessageType="phone",a.phoneObj||(a.phoneObj={}),a.phoneObj.phoneNumber_consent=!0,b.init&&b.init.initCountry&&(a.form.initCountry=b.init.initCountry);break;case"number":a.removeNumberField=!1;break;case"name":a.removeNameField=!1,a.nextMessageType="name",setTimeout(function(){socket.emit("login",{entityID:trilyoBearer,senderID:senderID})},3e3),setTimeout(function(){socket.emit("login",{entityID:trilyoBearer,senderID:senderID})},5e3),setTimeout(function(){socket.emit("login",{entityID:trilyoBearer,senderID:senderID})},1e4);break;case"personalform":a.removeBookingWidget=!1,b.init&&(a.personalform=b.init);break;case"bookingform":if(a.removeBookingForm=!1,b.init)if(a.form.city=null,a.form.hotel=null,b.init.checkin?(a.form.init=b.init,a.form.checkin=b.init.checkin):(a.form.init=null,a.form.checkin=null,a.form.checkout=null),b.init.property&&(a.form.property=b.init.property),b.init.checkout&&(a.form.checkout=b.init.checkout),!b.init.adults||b.init.adults instanceof Array||(a.form.adults=parseInt(b.init.adults+"")),b.init.adults&&b.init.adults instanceof Array&&b.init.adults.length>0&&(a.form.adults=parseInt(b.init.adults[0]+"")),!b.init.children||b.init.children instanceof Array||(a.form.children=parseInt(b.init.children+"")),b.init.children&&b.init.children instanceof Array&&b.init.children.length>0&&(a.form.children=parseInt(b.init.children[0]+"")),b.init.specialRequest&&(a.form.specialRequest=b.init.specialRequest),b.init.checksum&&(a.form.checksum=b.init.checksum),b.init.formConfig){if(a.form.formConfig=b.init.formConfig,a.form.formConfig.destinations){a.form.formConfig.cities=[];for(var l in a.form.formConfig.destinations){var m=a.form.formConfig.destinations[l],n=!1;for(var p in a.form.formConfig.cities){var q=a.form.formConfig.cities[p];if(q.id==m.city.id){n=!0;break}}n||(a.form.formConfig.cities.push(m.city),b.init.city&&m.city.name.toLowerCase()==b.init.city.toLowerCase()&&(a.form.city=m.city.id)),b.init.property||(b.init.property=""),b.init.property&&a.form.formConfig.destinations[l].hotel.name.toLowerCase()==b.init.property.toLowerCase()&&(a.form.hotel=a.form.formConfig.destinations[l].hotel.id,a.form.city=a.form.formConfig.destinations[l].city.id)}a.form.city&&!a.form.hotel&&a.onCitySelection()}}else a.form.formConfig=null;break;case"form":if(a.removeGenericForm=!1,b.init){a.genericForm=b.init,a.genericForm.data={};for(var r in a.genericForm.formConfig.init.sections){var s=a.genericForm.formConfig.init.sections[r];for(var t in s.fields){var u=s.fields[t];for(var v in u){var w=u[v];w.value&&(a.genericForm.data[w.field]=w.value),"autocomplete"==w.type&&(a.genericForm.autocompleteOptions=w.options)}}}}break;case"banquetform":a.removeBanquetForm=!1,b.init.date&&(a.banquet.dte=b.init.date),b.init.property&&(a.banquet.property=b.init.property),b.init.pax&&(a.banquet.pax=parseInt(b.init.pax)),b.init.customer_name&&(a.banquet.customer_name=b.init.customer_name),b.init.customer_phone&&"unavailable"!=b.init.customer_phone.toLowerCase()?a.banquet.customer_phone=b.init.customer_phone:a.banquet.customer_phone=null,b.init.checksum&&(a.banquet.checksum=b.init.checksum);break;case"restaurantform":a.removeRestaurantForm=!1,b.init.date&&(a.restro.dte=b.init.date),b.init.property&&(a.restro.property=b.init.property),b.init.time&&(a.restro.timings=b.init.time),b.init.pax&&(a.restro.pax=parseInt(b.init.pax+"")),b.init.customer_name&&(a.restro.customer_name=b.init.customer_name),b.init.customer_name&&(a.restro.customer_email=b.init.customer_email),b.init.customer_phone&&"unavailable"!=b.init.customer_phone.toLowerCase()?a.restro.customer_phone=b.init.customer_phone:a.restro.customer_phone=null,b.init.checksum&&(a.restro.checksum=b.init.checksum),b.init.formConfig&&(a.restro.formConfig=b.init.formConfig),b.init.formConfig.mode&&(a.restro.mode=b.init.formConfig.mode,"medical"==b.init.formConfig.mode&&(a.restro.specialRequest=null));break;case"membershipform":a.removeMembershipForm=!1,b.init.customer_name&&(a.membership.customer_name=b.init.customer_name),b.init.customer_email&&(a.membership.customer_email=b.init.customer_email),b.init.customer_phone&&"unavailable"!=b.init.customer_phone.toLowerCase()?a.membership.customer_phone=b.init.customer_phone:a.membership.customer_phone=null,b.init.checksum&&(a.membership.checksum=b.init.checksum);break;case"contactform":a.removeContactForm=!1,b.init.customer_name&&(a.contactform.customer_name=b.init.customer_name),b.init.customer_email&&(a.contactform.customer_email=b.init.customer_email),b.init.customer_phone&&"unavailable"!=b.init.customer_phone.toLowerCase()?a.contactform.customer_phone=b.init.customer_phone:a.contactform.customer_phone=null,b.init.checksum&&(a.contactform.checksum=b.init.checksum)}if(b.input&&!b.input.replyTo&&b.input.toLowerCase().indexOf("range")>-1){var x=b.input.substring(6).split(",");b.init={},b.init={},b.init.min=x[0],b.init.max=x[1],b.init.prefix=x[2],a.range={min:b.init.min,max:b.init.max,prefix:b.init.prefix},o.push({chatInputMsg:"",meta:c.trustAsHtml(b.text),chatOutputMsg:b.init.input,senderId:a.userId,type:"range"})}else o.push({chatInputMsg:"",meta:c.trustAsHtml(b.text),chatOutputMsg:b.input,senderId:a.userId,type:"input"})}b.status||(void 0!=b.required&&1==b.required?($("#messageInput").val()||($(".chat-user-input").css("visibility","hidden"),a.skipInput=!1,a.predictiveEnabled=!1,$(".trilyo-chat-body").css("bottom","58px")),a.skipInput=!1,a.predictiveEnabled=!1):($(".chat-user-input").css("visibility","visible"),a.skipInput=!0,$(".trilyo-chat-body").css("bottom","110px"),a.skipInput=!0),d||b.takePermission||(!audReceive||d||a.muted||disable_sounds||audReceive.play().catch(function(a){console.log("not played")}),e(function(){a.$$phase||a.$apply()},0),e(function(){a.scroll()},10),j(b,"b"))),setTimeout(function(){a.typing=!1},300),setTimeout(function(){if(a.typing=!1,$(".autocomplete_generic")&&a.genericForm&&a.genericForm.autocompleteOptions){try{$(".autocomplete_generic").autocomplete("destroy")}catch(a){}a.scroll(),$(".autocomplete_generic").autocomplete({source:a.genericForm.autocompleteOptions,appendTo:".autocomplete-container",change:function(a,b){$(this).val(b.item?b.item.value:"")}})}},2e3)}function j(a,b){B.push({message:a,direction:b,time:(new Date).getTime()}),"undefined"!=typeof Storage&&storageAvailable("localStorage")&&localStorage.setItem(CID,angular.toJson(B))}function k(){if("undefined"!=typeof Storage&&storageAvailable("localStorage")){var a=localStorage.getItem(CID);if(a)try{if(a=JSON.parse(a),Array.isArray(a)&&a.length>0&&a[0].direction)return JSON.stringify(a)}catch(a){return null}}return null}function l(){if("undefined"!=typeof Storage&&storageAvailable("localStorage")){var a=localStorage.getItem(AID);if(a)try{if(a=JSON.parse(a),Array.isArray(a)&&a.length>0&&a[0].direction)return JSON.stringify(a)}catch(a){return null}}return null}function m(a){$.cookie(SID)||(console.log("GET STARTED",$.cookie(SID)),$.ajax({type:"POST",url:baseUrl,contentType:"application/json; charset=utf-8",headers:{Authorization:"Bearer "+trilyoBearer,"x-current-url":a},data:JSON.stringify({register:{sender:senderID,getStarted:!0,user:{name:userName,email:email,phone:phone}},lang:"en",url:a}),dataType:"json",success:function(a){var b=new Date;b.setTime(b.getTime()+36e5),$.cookie(SID,!0,{expires:b,path:"/"}),console.log("SETTING COOKIE",SID)},error:function(a){console.log(a)}}))}function n(b){if(a.loaded)return void console.log("CALLED FROM OTHER THING");a.loaded=!0;var c=!1;$.cookie(RID)&&(console.log("Returning"),c=!0);var d=k(),e=l()||[];d&&inIframe()&&!$.cookie(RID)&&(e.push(d),"undefined"!=typeof Storage&&storageAvailable("localStorage")&&localStorage.setItem(AID,angular.toJson(e)),localStorage.removeItem(CID),B=[]);var f=0;console.log("REGISTER");var g;(startAt&&startAt.title||startAt.payload)&&(localStorage.removeItem(CID),B=[],g=startAt.payload),$.ajax({type:"POST",url:baseUrl,contentType:"application/json; charset=utf-8",headers:{Authorization:"Bearer "+trilyoBearer,"x-current-url":b},data:JSON.stringify({register:{payload:g,sv:sv,sender:senderID,alreadyRegistered:c,user:{name:userName,email:email,phone:phone}},lang:"en",url:b}),dataType:"json",success:function(b){if(a.typing=!1,a.$$phase||a.$apply(),b.message){if(b.message.welcome=!0,b.message.text instanceof Array){i({text:b.message.text[0].message,welcome:!0}),f++;var c=setInterval(function(){return"undefined"!=typeof Storage&&storageAvailable("localStorage")&&"true"==localStorage.getItem("chat-initiated-"+trilyoBearer)||chatOpened?void clearInterval(c):f>=b.message.text.length?void clearInterval(c):(i({text:b.message.text[f].message,welcome:!0}),void f++)},1e4)}else i(b.message);var d=new Date;d.setTime(d.getTime()+36e5),$.cookie(RID,!0,{expires:d,path:"/"})}},error:function(a){}})}a.alreadyChatting=!1,a.headerPayload=headerPayload,a.logo=brandLogo,a.props=props,a.search={},a.modalMode=!1,a.watchersList=[];var o=[];a.predictiveEnabled=!1,a.toggleMultiselect=function(b,c){void 0===b.selected?b.selected=!0:b.selected=!b.selected,a.itemSelected=!1;for(var d in c)if(c[d].selected){a.itemSelected=!0;break}},a.enablePredictive=function(){return setTimeout(function(){predictiveEnabled&&o&&o.length>1&&!a.predictiveEnabled&&$("#messageInput").length>0&&(a.predictiveEnabled=!0,$.typeahead({input:"#messageInput",order:"desc",source:{ajax:function(a){return console.log("query",a),{method:"post",url:"/getSuggestions/"+trilyoBearer,path:"sentences"}}},hint:!0,maxItem:4,callback:{onInit:function(a){console.log("Typeahead Initiated on "+a.selector)},onEnter:function(){console.log("CALLED")}}}))},500),!0},a.selectGeoLocation=function(b){a.payload(null,JSON.stringify(b),b.formatted_address)},a.newsLetterPayload=newsLetterPayload,a.openExtension=function(a,b,c,d,e){if(e){var f=new URL(a);f.searchParams.append("data",encodeURIComponent(JSON.stringify(e))),a=f.href}parent.postMessage({type:"openWebView",message:{url:a,title:b,height:c,width:d}},"*")},a.emitEvent=function(a){parent.postMessage({type:"event",action:a},"*")},$(document).ready(function(){$(".deal-cards .owl-next").click(function(){a.emitEvent("Welcome Offer Viewed")}),$(".deal-cards .owl-prev").click(function(){a.emitEvent("Welcome Offer Viewed")})}),a.redirectMessage=function(a){parent.postMessage({type:"redirect",message:{url:a}},"*")},a.sendMail=function(a){location.href="mailto:"+a},a.clear=function(a,b){var c="";if("sentence"===a)c=document.getElementById("suggestionSentence").innerText,document.getElementById("messageInput").value+=c;else{for(var d=document.getElementsByClassName("suggestionPill"),e=0;e<d.length;e++)d[e]===b&&(c=d[e].innerText.trim());document.getElementById("messageInput").value=c}document.getElementById("suggestionPills").innerHTML="",document.getElementById("suggestionSentence").innerText="",document.getElementById("suggestions").style.display="none"},$(document).ready(function(){$(document).on("click",".primary-action",function(){$(this).is(":disabled")||$(this).hasClass("disabled")||($(".chat-user-input").css("visibility","visible"),a.skipInput=!0,$(".trilyo-chat-body").css("bottom","110px"))})});var p=window.addEventListener?"addEventListener":"attachEvent";(0,window[p])("attachEvent"===p?"onmessage":"message",function(b){if("requestfocus"==b.data)document.getElementsByClassName("header-content")[0],chatOpened=!0,$("#messageInput").focus(),showIntro?(a.page=1,a.isChat=!1,a.predictiveEnabled=!1,alterImages()):(a.alreadyChatting=!0,a.page=2,a.isChat=!0,a.enablePredictive(),alterImages(),m()),a.$$phase||a.$apply(),setTimeout(function(){a.animations=!0},1e3);else if("startchatting"==b.data)console.log("START CHATTING"),a.startchat(),chatOpened=!0;else if("string"==typeof b.data&&b.data&&"url:"==b.data.substring(0,4).toLowerCase()){var c=b.data.substring(4);n(c)}}),e(function(){parent.postMessage("loaded","*")},500),a.muted=!1,a.typingA={},a.typingA.queryMsg="",a.mute=function(b){a.muted=b,a.$$phase||a.$apply()};try{audSend=new Audio("https://content.trilyo.com/script-assets/send.mp3"),audReceive=new Audio("https://content.trilyo.com/script-assets/receive.mp3")}catch(a){}a.messageSaved="",a.idleTime=0;var q=0,r=0;a.skipInput=!0,a.day=moment();var s=baseUrl;a.userId=senderID,a.regEx=/^[a-zA-Z][a-zA-Z0-9._][a-zA-Z0-9._]+@[A-Za-z0-9]+\.[a-z.]{1,5}$/,a.nameRegEx=/^[a-zA-Z][ a-zA-Z0-9._][ a-zA-Z0-9._]+$/,a.numericError=!1,a.typing=!0,setTimeout(function(){a.typing=!1},2e3),a.showmask=!1,a.menu=menu,a.quickMenu=quickMenu,a.enabled_languages=!!langs,a.languageShow=!1,a.searchtext="",a.hasIntro=showIntro,a.isChat=!showIntro,inIframe()?a.isNotIframe=!1:(a.isChat=!0,a.enablePredictive(),a.isNotIframe=!0,a.hasIntro=!1),showIntro&&(a.page=1),a.showNewsLetter=!1,a.storyimage="",a.langs=langs,a.brand_name=brand_name,menu&&alwaysShow&&(a.alwaysShowMenu=!0),a.locale=$.cookie("default_locale")||default_locale,a.optionsForBanquet=["Morning","Afternoon","Evening","Full Day"],a.occasions=["Corporate Meeting","Wedding","Birthday Party","Other"],a.membership_income=["3-8 Lpa","8-15 Lpa","15-22 Lpa","22+ Lpa"],a.membership_occupations=["Self-Employed","Government/PSU","Private Sector","Doctor","Engineer","Other"],a.membership_age_groups=["18-30 yrs","30-50 yrs","50+ yrs"],a.paxoptions=["0-50","50-100","100-150","150-200","200-300","300-400","400-500","500+"],a.form={adults:2,children:0,specialRequest:"none"},a.banquet={specialRequest:"none"},a.restro={specialRequest:"none",pax:2},a.membership={specialRequest:"none"},a.contactform={},a.addressForm={},a.ipInfo={},a.deals=deals,a.stories=stories,$.cookie(LID)?a.leadDone=!0:a.leadDone=!1,a.startchat=function(){a.alreadyChatting=!0,a.animations=!0,setTimeout(function(){alterImages(),$(".trilyo-chat-body").scrollTop(999999999999)},100),a.isChat=!0,a.page=2,m(),a.$$phase||a.$apply(),setTimeout(function(){a.enablePredictive()},500)},a.startintro=function(){a.isChat=!1,a.predictiveEnabled=!1,a.page=1,a.$$phase||a.$apply(),setTimeout(function(){alterImages()},1e3),console.log("Alter images")},a.sendMsgByEnter=function(c,d){r&&clearTimeout(r),idleTime2=250,r=setTimeout(function(){if(idleTime2=0,corrected>""){var a=document.getElementById("messageInput");a.value=corrected,a.value+=" ",a.focus();var b=document.getElementById("suggestions"),c=getXY(a,a.value.length);b.style.position="relative",b.style.left=c.x+"px",b.style.top=c.y+"px"}},idleTime2),32==c.which||(13==c.which||"submit"==c.type||"Enter"==d?(c.preventDefault(),""!=a.typingA.queryMsg&&(a.removeEmailField=!1,a.removeNameField=!1,a.removePhoneField=!1,a.removeNumberField=!1,a.removeQuickReply=!1,A($("#messageInput").val()))):(q&&clearTimeout(q),a.idleTime=1e3,q=setTimeout(function(){if(a.idleTime=0,a.messageSaved.length>0&&(!$("#messageInput").val()||""==$("#messageInput").val().trim())){a.typing=!0;var c={message:{text:a.messageSaved.trim()},senderID:a.userId,ipInfo:a.ipInfo,traffic_source:ref,utm_campaign:utm_campaign,utm_medium:utm_medium,utm_content:utm_content,utm_source:utm_source,utm_term:utm_term,device_info:device_info};c.locale=a.locale,b.post(s,angular.toJson(c),{headers:{Authorization:"Bearer "+trilyoBearer,"Content-Type":"application/json","x-current-url":url}}).success(function(b){if(a.typing=!1,a.messageSaved="",b.leadCaptured){var c=new Date;c.setTime(9e13),$.cookie(LID,!0,{expires:c,path:"/"}),a.leadDone=!0,a.$$phase||a.$apply()}i(b)}).error(function(b){$(".seen-chat").css("display","none"),a.typing=!1,a.messageSaved=""})}},2e3)))},a.saveAddress=function(){var b=JSON.stringify(a.addressForm);a.payload(null,b,"Submit")},a.addhttp=function(a,b,c){return a.match(/^[a-zA-Z]+:\/\//)||(a="https://"+a),serverURL+"redirector?account_id="+trilyoBearer+"&sender_id="+senderID+"&source_id=2&save_chat_history=true&redirect_url="+encodeURIComponent(a)+(b?"&ref="+b+"("+c+")":"")},a.subscribe=function(){a.isChat=!0,a.enablePredictive(),a.page=2,a.showMenu=!1,a.showmask=!1;var d="Please add me to your mailing list, my email is "+a.subscribe.subscribeEmail,f=d;d=linkify(boldify(d)),j(d,"u"),o.push({chatInputMsg:c.trustAsHtml(d),chatOutputMsg:"",senderId:a.userId,seenvisibility:!0});var g={postback:{payload:a.newsLetterPayload,title:f},senderID:a.userId,ipInfo:a.ipInfo,traffic_source:ref,utm_campaign:utm_campaign,utm_medium:utm_medium,utm_content:utm_content,utm_source:utm_source,utm_term:utm_term,device_info:device_info};a.subscribe.subscribeEmail="",a.newsLetterPayload="",b.post(s,angular.toJson(g),{headers:{Authorization:"Bearer "+trilyoBearer,"Content-Type":"application/json"}}).success(function(b){if(a.messageSaved="",b.leadCaptured){var c=new Date;c.setTime(9e13),$.cookie(LID,!0,{expires:c,path:"/"}),a.leadDone=!0,a.$$phase||a.$apply()}}).error(function(b){$(".seen-chat").css("display","none"),a.typing=!1,a.messageSaved=""}),a.$$phase||a.$apply(),e(function(){a.scroll(),$(".chat-user-input").css("visibility","visible"),a.skipInput=!0,$(".trilyo-chat-body").css("bottom","110px"),$("#messageInput").focus()},10)},a.scrolling=!1,a.scroll=function(b){if(!a.scrolling){if(a.scrolling=!0,b)var c=b;else var c=$(".buddy-chat").last();try{var d=c.position().top+c.height();$(".trilyo-chat-body").animate({scrollTop:d},500,function(){a.scrolling=!1}),$("#trilyo-chat-body-inner").animate({scrollTop:d},500,function(){a.scrolling=!1})}catch(b){a.scrolling=!1}}},a.like=function(){a.isChat=!0,a.enablePredictive(),a.page=2,a.showMenu=!1,a.showmask=!1;var d='<i class="fa fa-thumbs-up"></i>';j(d,"u"),o.push({chatInputMsg:c.trustAsHtml(d),chatOutputMsg:"",senderId:a.userId,seenvisibility:!0});var f={message:{text:":like:"},senderID:a.userId,ipInfo:a.ipInfo,traffic_source:ref,utm_campaign:utm_campaign,utm_medium:utm_medium,utm_content:utm_content,utm_source:utm_source,utm_term:utm_term,device_info:device_info};b.post(s,angular.toJson(f),{headers:{Authorization:"Bearer "+trilyoBearer,"Content-Type":"application/json"}}).success(function(b){if(a.messageSaved="",b.leadCaptured){var c=new Date;c.setTime(9e13),$.cookie(LID,!0,{expires:c,path:"/"}),a.leadDone=!0,a.$$phase||a.$apply()}}).error(function(b){$(".seen-chat").css("display","none"),a.typing=!1,a.messageSaved=""}),a.$$phase||a.$apply(),e(function(){a.scroll(),$(".chat-user-input").css("visibility","visible"),a.skipInput=!0,$(".trilyo-chat-body").css("bottom","110px"),$("#messageInput").focus()},10)},a.runDefaultAction=function(b){b.default_action&&("web_url"==b.default_action.type?b.default_action.url&&(b.default_action.messenger_extension?parent.postMessage({type:"openWebView",message:{url:b.default_action.url,title:b.title,height:b.default_action.height,width:b.default_action.width}},"*"):window.open(b.default_action.url)):"postback"==b.default_action.type&&a.payload(b.default_action.payload,b.title))},a.act=function(b){console.log("ACTING",b),"web_url"==b.default_action.type?window.open(b.default_action.url,"_blank"):a.payload(b.default_action.payload,b.title)},a.payload=function(b,c,d){console.log("IN PAYLOAD"),a.hidemodals(!0),a.isChat=!0,a.enablePredictive(),a.page=2,a.scroll(),$(".chat-user-input").css("visibility","visible"),a.skipInput=!0,$(".trilyo-chat-body").css("bottom","110px"),a.showMenu=!1,a.showmask=!1,A(c,b,!1,d)},a.quickReply=function(b,c){$(".chat-user-input").css("visibility","visible"),a.skipInput=!0,$(".trilyo-chat-body").css("bottom","110px"),a.removeQuickReply=!0,A(c,b)},a.findMe=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){a.coords.latitude,a.coords.longitude;A(angular.toJson({lat:+a.coords.latitude,long:+a.coords.longitude}))},function(){g(!0)}):g(!1)},a.clickEmail=function(b){a.emailError=!1,void 0!=$(this)[0].email&&""!=$(this)[0].email?(a.removeEmailField=!0,A($(this)[0].email)):a.emailError=!0},a.sendEmailMsgByEnter=function(b){void 0!=$(this)[0].email&&""!=$(this)[0].email?(a.emailError=!1,13==b.which&&(a.emailError=!1,a.removeEmailField=!0,A($(this)[0].email))):(console.log("FOM HERE"),a.emailError=!0)},a.clickName=function(b){void 0!=$(this)[0].user_name&&""!=$(this)[0].user_name&&(a.removeNameField=!0,A($(this)[0].user_name))},a.handleCloseClick=function(){parent.postMessage("close","*"),a.animations=!1,a.isChat=!1,a.predictiveEnabled=!1,a.hasIntro?a.page=1:a.page=2,chatOpened=!1},a.sendNameMsgByEnter=function(b){void 0!=$(this)[0].user_name&&""!=$(this)[0].user_name&&13==b.which&&(a.removeNameField=!0,A($(this)[0].user_name))},a.clickPhonSubmit=function(b){if(a.phoneError=!1,void 0!=$(this)[0].phoneNumber&&""!=$(this)[0].phoneNumber){var c=$(b.target).parents(".form-elementgroup").find('input[type="tel"]'),d=c.intlTelInput("isValidNumber"),e=c.intlTelInput("getNumber");1==d?(a.phoneError=!1,a.removePhoneField=!0,A(e)):a.phoneError=!0}},a.sendPhoneNumberMsgByEnter=function(b){if(a.phoneError=!1,13==b.which&&void 0!=$(this)[0].phoneNumber&&""!=$(this)[0].phoneNumber){var c=b.target,d=$(c).intlTelInput("isValidNumber"),e=$(c).intlTelInput("getNumber"),f=!!a.phoneObj&&a.phoneObj.phoneNumber_consent;console.log("consent",f),f&&(e="My Phone number is "+e+". Please keep me updated over whatsapp"),1==d?(a.phoneError=!1,a.removePhoneField=!0,A(e)):a.phoneError=!0}},a.sendMsgByClick=function(){""!=$("#messageInput").val()&&(a.removeEmailField=!1,a.removeNameField=!1,a.removePhoneField=!1,a.removeNumberField=!1,a.removeQuickReply=!1,A($("#messageInput").val()))},a.clickNumberSubmit=function(){void 0!=$(this)[0].number&&""!=$(this)[0].number&&(a.removeNumberField=!0,a.numericError=!1,A($(this)[0].number))},a.sendNumberMsgByEnter=function(b){void 0!=$(this)[0].number&&""!=$(this)[0].number&&13==b.which&&(a.removeNumberField=!0,a.numericError=!1,A($(this)[0].number))},a.rateFunction=function(a){A(a)},a.setRangeValue=function(b,c){var d=a.range.prefix+" "+b+" - "+a.range.prefix+" "+c;A(d)},a.showMenu=!1,a.toggelMenu=function(){a.hidemodals(!0),$("#clickSection").removeClass("blink_me"),a.showMenu?(a.showMenu=!1,a.showmask=!1,fbLoaded&&fbPageId&&($(".adMessage").fadeIn(500),$(".trilyo-chat-body").css("bottom","167px"))):(a.hidemodals(),a.showmask=!0,a.showMenu=!0,fbLoaded&&fbPageId&&($(".adMessage").hide(),$(".trilyo-chat-body").css("bottom","100px"))),a.$$phase||a.$apply()},a.filterlangs=function(b){for(var c=0;c<a.langs.length;c++)a.langs[c].visible=!1;for(var c=0;c<a.langs.length;c++)a.langs[c].name.toLowerCase().indexOf(a.searchtext.toLowerCase())>=0&&(a.langs[c].visible=!0)},String.prototype.fuzzyMatch=function(a){if(this.toString().indexOf(a)>-1)return 1;for(var b=this.toString().replace(/,/g," ").split(" "),c=0;c<b.length;c++)if(JaroWinklerDistance(b[c],a)>.85)return 1;return JaroWinklerDistance(this.toString(),a)>.85?1:-1},a.filteropts=function(b){for(var c=0;c<a.search.dataset.length;c++)if(a.search.dataset[c].helper="",a.search.dataset[c].name.toLowerCase().fuzzyMatch(a.search.searchtext.toLowerCase())>-1)a.search.dataset[c].visible=!0;else if(a.search.dataset[c].visible=!1,a.search.dataset[c].dimensions)for(var d="",e=0;e<a.search.dataset[c].dimensions.length;e++)for(var f=0;f<a.search.dataset[c].dimensions[e].values.length;f++)a.search.dataset[c].dimensions[e].values[f].toLowerCase().fuzzyMatch(a.search.searchtext.toLowerCase())>-1?(a.search.dataset[c].visible=!0,d+=" "+a.search.dataset[c].dimensions[e].name+" : ",d+=a.search.dataset[c].dimensions[e].values[f],a.search.dataset[c].helper=d):d="";a.$$phase||a.$apply()},a.hidemodals=function(b){!b&&a.modalMode||(a.languageShow=!1,a.showMenu=!1,a.openSearch=!1,a.showmask=!1,a.$$phase||a.$apply(),a.modalMode=!1),a.search.searchtext=""},a.selectlang=function(b){a.hidemodals(!0);for(var c=0;c<a.langs.length;c++)if(b==a.langs[c].id){a.langs[c].selected=!0,a.locale=a.langs[c].locale;var d=new Date;d.setTime(d.getTime()+36e5),$.cookie("default_locale",a.locale,{expires:d,path:"/"})}else a.langs[c].selected=!1},a.loadLang=function(){for(var b=0;b<a.langs.length;b++)if(a.locale==a.langs[b].locale){a.langs[b].selected=!0;var c=new Date;c.setTime(c.getTime()+36e5),$.cookie("default_locale",a.locale,{expires:c,path:"/"})}else a.langs[b].selected=!1},a.loadLang(),a.togglelanguage=function(){a.languageShow?(a.languageShow=!1,a.showmask=!1):(a.hidemodals(),a.languageShow=!0,a.showmask=!0)},a.mask=function(){a.showmask=!0},a.hideMenu=function(){a.showMenu=!1,$("#trilyo_persitent_menu").menu("collapseAll",null,!0),fbLoaded&&fbPageId&&$(".adMessage").fadeIn(500),a.$$phase||a.$apply()},a.getStoryImage=function(a){if(new RegExp("youtube").test(a))return{background:"url('https://img.youtube.com/vi/"+a.substr(30)+"/0.jpg')","background-size":"cover"};return{background:"url('"+a+"')","background-size":"cover"}},a.knowMoreStory=function(){var b=$(".story-image").attr("index");a.stories.forEach(function(c,d){d==b&&(a.isChat=!0,a.enablePredictive(),$(".intro-header").removeClass("slideOutUp animated"),$(".intro-header").removeClass("slideInDown animated"),a.closestory(),a.payload(c.buttons[0].payload,c.buttons[0].title))})},a.showstory=function(a,b,c){$(".story-viewer").css("display","block"),$(".story-viewer").removeClass("zoomOut"),$(".story-viewer").addClass("animated zoomIn"),$(".intro-header").removeClass("slideInUp animated"),$(".intro-header").addClass("slideOutUp animated"),$(".story-image").attr("index",b),$(".story-control button").html(c[0].title),$(".trilyo-chat-intro").scrollTop(0),new RegExp("youtube").test(a)?(a+="?autoplay=1&rel=0&modestbranding=1&showtitle=0&showinfo=0&fs=0&controls=0&showinfo=0",$(".story-image").css("background-image","url('')"),$(".story-image").html("<iframe style='width:100%;height:100%;' frameBorder='0' src='"+a+"'></iframe>")):($(".story-image iframe").remove(),$(".story-image").css("background-image","url('"+a+"')"),$(".story-image").css("background-size","cover"))},a.closestory=function(){$(".story-viewer").removeClass("zoomIn"),$(".story-viewer").addClass("animated zoomOut"),$(".story-image iframe")&&$(".story-image iframe").remove(),$(".intro-header").removeClass("slideOutUp animated"),$(".intro-header").addClass("slideInDown animated"),setTimeout(function(){$(".story-viewer").css("display","none"),$(".intro-header").removeClass("slideInDown animated")},1e3)};var t=function(c){var d={};d.checksum=a.restro.checksum,d.payload=c,d.sender_id=senderID,d.source="webapp",b.post(serverURLRoot+"/booking_form/webhook",d,{headers:{Authorization:"Bearer "+trilyoBearer,"Content-Type":"application/json"}}).success(function(a){}).error(function(a){})};a.submitMultiQuickReply=function(b){var c="";for(var d in b){var e=b[d];e.selected&&(c+=e.title+", ")}if(!(c.length>0))return void a.payload(b[0].payload,"None");c=c.substring(0,c.length-2),a.payload(b[0].payload,c)},a.submitMCQ=function(){var b="";if($(".mcq:checked").each(function(a,c){b+=$(this).val()+","}),!(b.length>0))return void a.payload(void 0,"None");b=b.substring(0,b.length-1),a.payload(void 0,b)},a.submitPersonalDetails=function(b){switch(b){case"submit":a.personalform.personal_sub=!0,a.personalform.personal_skip=!1,u(a.personalform);var d="Confirm";break;case"skip":a.personalform.personal_sub=!1,a.personalform.personal_skip=!0,u(a.personalform);var d="Cancel"}o.push({chatInputMsg:c.trustAsHtml(d),chatOutputMsg:"",senderId:a.userId,seenvisibility:!0}),a.ClintChatMessages=o,a.removeBanquetForm=!0,e(function(){a.isEmailField=!0,a.isNameField=!0,a.isPhoneField=!0,a.isNumberField=!0,a.scroll(),$(".chat-user-input").css("visibility","visible"),a.skipInput=!0,$(".trilyo-chat-body").css("bottom","110px"),$("#messageInput").focus()},1500),j(d,"u")},a.submitBanquetBooking=function(b){switch(b){case"submit":a.banquet.banquet_sub=!0,a.banquet.banquet_skip=!1,v(a.banquet);var d="Submit";break;case"skip":a.banquet.banquet_sub=!1,a.banquet.banquet_skip=!0,v(a.banquet);var d="Cancel"}o.push({chatInputMsg:c.trustAsHtml(d),chatOutputMsg:"",senderId:a.userId,seenvisibility:!0}),a.ClintChatMessages=o,a.removeBanquetForm=!0,e(function(){a.isEmailField=!0,a.isNameField=!0,a.isPhoneField=!0,a.isNumberField=!0,a.scroll(),$(".chat-user-input").css("visibility","visible"),a.skipInput=!0,$(".trilyo-chat-body").css("bottom","110px"),$("#messageInput").focus()},1500),j(d,"u")};var u=function(c){var d={};d.checksum=a.personalform.checksum,d.payload=c,d.sender_id=senderID,d.source="webapp",b.post(serverURLRoot+"/booking_form/webhook",d,{headers:{Authorization:"Bearer "+trilyoBearer,"Content-Type":"application/json"}}).success(function(a){}).error(function(a){})},v=function(c){var d={};d.checksum=a.banquet.checksum,d.payload=c,d.sender_id=senderID,d.source="webapp",b.post(serverURLRoot+"/booking_form/webhook",d,{headers:{Authorization:"Bearer "+trilyoBearer,"Content-Type":"application/json"}}).success(function(a){}).error(function(a){})};a.submitRestroBooking=function(b){switch(b){case"submit":a.restro.restro_sub=!0,a.restro.restro_skip=!1,t(a.restro);var d="Submit";break;case"skip":a.restro.restro_sub=!1,a.restro.restro_skip=!0,t(a.restro);var d="Cancel"}o.push({chatInputMsg:c.trustAsHtml(d),chatOutputMsg:"",senderId:a.userId,seenvisibility:!0}),a.ClintChatMessages=o,a.removeRestaurantForm=!0,e(function(){a.isEmailField=!0,a.isNameField=!0,a.isPhoneField=!0,a.isNumberField=!0,a.scroll(),$(".chat-user-input").css("visibility","visible"),a.skipInput=!0,$(".trilyo-chat-body").css("bottom","110px"),$("#messageInput").focus()},1500),j(d,"u")},a.submitGenericForm=function(b,d){if(d&&d.cta)var f=d.cta.url,g=d.cta.method,h=d.cta.headers,i=d.cta.data,k=d.cta.dataType,l=d.cta.response,m=d.cta.messengerExtension,n=(d.cta.height,d.cta.width);try{for(var p in cl)cl[p]&&cl[p].calpicker("destroy")}catch(a){}if(f){var q=a.genericForm.data;baseUrl=baseUrl.replace("webapp/webhook","");var r=baseUrl+"redirector?account_id="+trilyoBearer+"&sender_id="+senderID+"&source_id=2&source=webapp&context="+encodeURIComponent(JSON.stringify(q))+"&save_chat_history=true&formtype=Booking&redirect_url=",s=resolveUrl(f,a.form,g,h,i,k,l);if(s instanceof Promise){var t=window.open("/loader.html","_blank");s.then(function(a){t.location.href=r+a})}else m?parent.postMessage({type:"openWebView",message:{url:s,title:"Booking",height:5e3,width:n}},"*"):window.open(r+encodeURIComponent(s));return o.push({chatInputMsg:c.trustAsHtml(a.form.formConfig.cta.text),chatOutputMsg:"",senderId:a.userId,seenvisibility:!0}),a.removeBookingForm=!0,void(a.$$phase||a.$apply())}switch(b){case"submit":a.genericForm.data.generic_sub=!0,a.genericForm.data.booking_skip=!1,a.genericForm.data.checksum=a.genericForm.checksum,a.genericForm.data.action=a.genericForm.formConfig.init.cta.success.action;for(var p in a.genericForm.formConfig.init.sections){var u=a.genericForm.formConfig.init.sections[p];for(var v in u.fields){var w=u.fields[v];for(var x in w){var y=w[x];if("dropdown"==y.type&&y.label_field)for(var A in y.config.options)if(a.genericForm.data[y.field]==y.config.options[A].value){a.genericForm.data[y.label_field]=y.config.options[A].label;break}}}}z(a.genericForm.data);var B=d&&d.cta&&d.cta.label?d.cta.label:"Submit";break;case"skip":a.genericForm.data.generic_sub=!1,a.genericForm.data.booking_skip=!0,a.genericForm.data.checksum=a.genericForm.checksum,z(a.genericForm.data);var B="Cancel"}o.push({chatInputMsg:c.trustAsHtml(B),chatOutputMsg:"",senderId:a.userId,seenvisibility:!0}),a.ClintChatMessages=o,a.removeGenericForm=!0,e(function(){a.isEmailField=!0,a.isNameField=!0,a.isPhoneField=!0,a.isNumberField=!0,a.scroll(),$(".chat-user-input").css("visibility","visible"),a.skipInput=!0,$(".trilyo-chat-body").css("bottom","110px"),$("#messageInput").focus()},1500),j(B,"u")},a.submitBooking=function(b,d){if(d&&d.cta)var f=d.cta.url,g=d.cta.method,h=d.cta.headers,i=d.cta.data,k=d.cta.dataType,l=d.cta.response,m=d.cta.messengerExtension,n=(d.cta.height,d.cta.width);try{for(var p in cl)cl[p]&&(cl[p].calpicker("destroy"),console.log("calpicker destroyed"))}catch(a){}if(f){var q={booking_checkinDate:a.form.checkin,booking_checkoutDate:a.form.checkout,lead_ts_traveling_with:a.form.traveling_with,booking_pax:a.form.adults,booking_children:a.form.children,specialRequest:a.form.specialRequest};a.form.numRooms&&(a.form.booking_num_rooms=a.form.numRooms);for(var r in a.form.context)q["lead_ts_"+r]=a.form.context[r];baseUrl=baseUrl.replace("webapp/webhook","");var s=baseUrl+"redirector?account_id="+trilyoBearer+"&sender_id="+senderID+"&source_id=2&source=webapp&context="+encodeURIComponent(JSON.stringify(q))+"&save_chat_history=true&formtype=Booking&redirect_url=",t=resolveUrl(f,a.form,g,h,i,k,l);if(t instanceof Promise){var u=window.open("/loader.html","_blank");t.then(function(a){u.location.href=s+a})}else m?parent.postMessage({type:"openWebView",message:{url:t,title:"Booking",height:5e3,width:n}},"*"):window.open(s+encodeURIComponent(t));return o.push({chatInputMsg:c.trustAsHtml(a.form.formConfig.cta.text),chatOutputMsg:"",senderId:a.userId,seenvisibility:!0}),a.removeBookingForm=!0,void(a.$$phase||a.$apply())}switch(b){case"submit":a.form.booking_sub=!0,a.form.booking_skip=!1,z(a.form);var v=a.form.formConfig&&a.form.formConfig.cta&&a.form.formConfig.cta.tex?a.form.formConfig.cta.text:"Submit";break;case"skip":a.form.booking_sub=!1,a.form.booking_skip=!0,z(a.form);var v="Cancel"}o.push({chatInputMsg:c.trustAsHtml(v),chatOutputMsg:"",senderId:a.userId,seenvisibility:!0}),a.ClintChatMessages=o,a.removeBookingForm=!0,e(function(){a.isEmailField=!0,a.isNameField=!0,a.isPhoneField=!0,a.isNumberField=!0,a.scroll(),$(".chat-user-input").css("visibility","visible"),a.skipInput=!0,$(".trilyo-chat-body").css("bottom","110px"),$("#messageInput").focus()},1500),j(v,"u")};var w=function(c){var d={};d.checksum=a.membership.checksum,d.payload=c,d.sender_id=senderID,d.source="webapp",b.post(serverURLRoot+"/booking_form/webhook",d,{headers:{Authorization:"Bearer "+trilyoBearer,"Content-Type":"application/json"}}).success(function(a){}).error(function(a){})},y=function(c){var d={};d.checksum=a.contactform.checksum,d.payload=c,d.sender_id=senderID,d.source="webapp",b.post(serverURLRoot+"/booking_form/webhook",d,{headers:{Authorization:"Bearer "+trilyoBearer,"Content-Type":"application/json"}}).success(function(a){}).error(function(a){})},z=function(c){var d={};d.checksum=c.checksum||a.form.checksum,d.payload=c,d.sender_id=senderID,d.source="webapp",b.post(serverURLRoot+"/booking_form/webhook",d,{headers:{Authorization:"Bearer "+trilyoBearer,"Content-Type":"application/json"}}).success(function(a){}).error(function(a){})};a.submitMembershipEnquiry=function(b){switch(b){case"submit":a.membership.membership_sub=!0,a.membership.membership_skip=!1;for(var d=!1,f=0;f<a.orgCities.length;f++)if(a.orgCities[f].cityName==a.membership.customer_city){a.membership.city_code=a.orgCities[f].cityCode,d=!0;break}d||(a.membership.city_code="BOMC"),w(a.membership);var g="Submit";break;case"skip":a.membership.membership_sub=!1,a.membership.membership_skip=!0,w(a.membership);var g="Cancel"}o.push({chatInputMsg:c.trustAsHtml(g),chatOutputMsg:"",senderId:a.userId,seenvisibility:!0}),a.ClintChatMessages=o,a.removeMembershipForm=!0,e(function(){a.isEmailField=!0,a.isNameField=!0,a.isPhoneField=!0,a.isNumberField=!0,a.scroll(),$(".chat-user-input").css("visibility","visible"),a.skipInput=!0,$(".trilyo-chat-body").css("bottom","110px"),$("#messageInput").focus()},1500),j(g,"u")},a.submitContactDetails=function(b){switch(b){case"submit":a.contactform.contact_sub=!0,a.contactform.contact_skip=!1,y(a.contactform);var d="Submit";break;case"skip":a.contactform.contact_sub=!1,a.contactform.contact_skip=!0,y(a.contactform);var d="Cancel"}o.push({chatInputMsg:c.trustAsHtml(d),chatOutputMsg:"",senderId:a.userId,seenvisibility:!0}),a.ClintChatMessages=o,a.removeContactForm=!0,e(function(){a.isEmailField=!0,a.isNameField=!0,a.isPhoneField=!0,a.isNumberField=!0,a.scroll(),$(".chat-user-input").css("visibility","visible"),a.skipInput=!0,$(".trilyo-chat-body").css("bottom","110px"),$("#messageInput").focus()},1500),j(d,"u")};var A=function(d,f,g,h){var k=0;for(var l in B){"u"==B[l].direction&&k++}k>0&&socket&&socket.emit("login",{entityID:trilyoBearer,senderID:senderID}),a.typingA.queryMsg="",$("#messageInput").val(""),a.$$phase||a.$apply(),"undefined"!=typeof Storage&&storageAvailable("localStorage")&&localStorage.setItem("chat-initiated-"+trilyoBearer,"true"),g||!audSend||a.muted||disable_sounds||audSend.play();var m=d;if(d=linkify(boldify(d)),h?o.push({chatInputMsg:c.trustAsHtml(h),chatOutputMsg:"",senderId:a.userId,seenvisibility:!0}):o.push({chatInputMsg:c.trustAsHtml(d),chatOutputMsg:"",senderId:a.userId,seenvisibility:!0}),!g){if(j(h||d,"u"),!f&&a.nextMessageType&&parent.postMessage({type:a.nextMessageType,message:m},"*"),e(function(){a.scroll()},10),void 0==f)var n={message:{text:m},senderID:a.userId,ipInfo:a.ipInfo,traffic_source:ref,utm_campaign:utm_campaign,utm_medium:utm_medium,utm_content:utm_content,utm_source:utm_source,utm_term:utm_term,device_info:device_info};else var n={postback:{payload:f,title:m},senderID:a.userId,ipInfo:a.ipInfo,traffic_source:ref,utm_campaign:utm_campaign,utm_medium:utm_medium,utm_content:utm_content,utm_source:utm_source,utm_term:utm_term,device_info:device_info};if(!$.cookie(LoID)){var p=new Date;p.setTime(p.getTime()+1008e5),$.cookie(LoID,!0,{expires:p,path:"/"}),socket.emit("login",{entityID:trilyoBearer,senderID:senderID})}if(n.locale=a.locale,!a.idleTime||0==a.idleTime||f){a.typing=!0;var q=n;b.post(s,angular.toJson(q),{headers:{Authorization:"Bearer "+trilyoBearer,"Content-Type":"application/json","x-current-url":url}}).success(function(b){if(a.messageSaved="",b.leadCaptured){var c=new Date;c.setTime(9e13),$.cookie(LID,!0,{expires:c,path:"/"}),a.leadDone=!0,a.$$phase||a.$apply()}a.typing=!1,i(b)}).error(function(b){$(".seen-chat").css("display","none"),a.typing=!1,a.messageSaved=""})}else a.messageSaved+=" "+n.message.text;a.ClintChatMessages=o,$("#messageInput").blur(),a.enablePredictive(),e(function(){a.isEmailField=!0,a.isNameField=!0,a.isPhoneField=!0,a.isNumberField=!0,a.scroll()},1500)}};a.orgCities=[{cityName:"Ahmedabad",cityCode:"AMD"},{cityName:"Bangalore",cityCode:"BLR"},{cityName:"Chandigarh",cityCode:"IXC"},{cityName:"Chennai",cityCode:"MAA"},{cityName:"Coimbatore",cityCode:"CJB"},{cityName:"Delhi - Central",cityCode:"DELHIC"},{cityName:"Delhi - East",cityCode:"DELHIE"},{cityName:"Delhi - North",cityCode:"DELHIN"},{cityName:"Delhi - South",cityCode:"DELHIS"},{cityName:"Delhi - West",cityCode:"DELHIW"},{cityName:"Hyderabad",cityCode:"HYD"},{cityName:"Indore",cityCode:"IDR"},{cityName:"Kochi",cityCode:"COK"},{cityName:"Kolkata",cityCode:"CCU"},{cityName:"Lucknow",cityCode:"LKO"},{cityName:"Mumbai - Western Suburbs",cityCode:"BOMW"},{cityName:"Mumbai - Central Suburbs",cityCode:"BOMC"},{cityName:"Mumbai - South Mumbai",cityCode:"BOMS"},{cityName:"Mumbai - Thane",cityCode:"BOMT"},{cityName:"Mumbai - Navi Mumbai",cityCode:"BOMN"},{cityName:"Mumbai - Kalyan &amp; Dombivali",cityCode:"BOMKD"},{cityName:"Pune",cityCode:"PNQ"},{cityName:"Surat",cityCode:"STV"},{cityName:"Sharjah",cityCode:"SHA"},{cityName:"Abu Dhabi",cityCode:"ABU"},{cityName:"Kuwait",cityCode:"KUW"},{cityName:"Saudi Arabia",cityCode:"SAA"},{cityName:"Dubai",cityCode:"DBI"},{cityName:"Qatar",cityCode:"QAT"},{cityName:"Oman",cityCode:"OMA"},{cityName:"Bahrain",cityCode:"BAHR"},{cityName:"Abohar",cityCode:"ABS"},{cityName:"Achalpur",cityCode:"ELP"},{cityName:"Adilabad",cityCode:"ADB"},{cityName:"Adityapur",cityCode:"ADTP"},{cityName:"Adoni",cityCode:"AD"},{cityName:"Agartala",cityCode:"IXA"},{cityName:"Agra",cityCode:"AGR"},{cityName:"Ahmednagar",cityCode:"ANG"},{cityName:"Aizawl",cityCode:"AIZ"},{cityName:"Ajman",cityCode:"AJM"},{cityName:"Ajmer",cityCode:"AII"},{cityName:"Akbarpur",cityCode:"ABP"},{cityName:"Akola",cityCode:"AK"},{cityName:"Al Ain",cityCode:"ALA"},{cityName:"Alappuzha",cityCode:"AMPA"},{cityName:"Aligarh",cityCode:"ALGN"},{cityName:"Allahabad",cityCode:"IXD"},{cityName:"Alwar",cityCode:"AWR"},{cityName:"Ambala",cityCode:"UBC"},{cityName:"Ambala Sadar",cityCode:"AMB"},{cityName:"Ambernath",cityCode:"ABH"},{cityName:"Ambikapur",cityCode:"ABKP"},{cityName:"Ambur",cityCode:"AB"},{cityName:"Amravati",cityCode:"AMRT"},{cityName:"Amreli",cityCode:"AE"},{cityName:"Amritsar",cityCode:"ATQ"},{cityName:"Amroha",cityCode:"AMRO"},{cityName:"Anand",cityCode:"ANND"},{cityName:"Anantapur",cityCode:"ATP"},{cityName:"Anantapuram",cityCode:"ANF"},{cityName:"Anantnag",cityCode:"ANT"},{cityName:"Arrah",cityCode:"ARR"},{cityName:"Asansol",cityCode:"ASN"},{cityName:"Ashokenagar Kalyangarh",cityCode:"ASHOK"},{cityName:"Aurangabad",cityCode:"IXU"},{cityName:"Auroville",cityCode:"AUR"},{cityName:"Azamgarh",cityCode:"AMH"},{cityName:"Badalapur",cityCode:"BUD"},{cityName:"Bagaha",cityCode:"BUG"},{cityName:"Bagalkot",cityCode:"BQZ"},{cityName:"Bahadurgarh",cityCode:"BGZ"},{cityName:"Baharampur",cityCode:"BAH"},{cityName:"Bahraich",cityCode:"BRK"},{cityName:"Baidyabati",cityCode:"BBAE"},{cityName:"Ballarpur",cityCode:"BLPR"},{cityName:"Baleshwar",cityCode:"BAL"},{cityName:"Ballia",cityCode:"BUI"},{cityName:"Bally Town",cityCode:"BLYT"},{cityName:"Balurghat",cityCode:"BLGT"},{cityName:"Banda",cityCode:"BND"},{cityName:"Bankura",cityCode:"BQA"},{cityName:"Bansberia",cityCode:"BANS"},{cityName:"Banswara",cityCode:"BAN"},{cityName:"Baran",cityCode:"BAZ"},{cityName:"Baranagar",cityCode:"BAR"},{cityName:"Barasat",cityCode:"BT"},{cityName:"Baraut",cityCode:"BTU"},{cityName:"Bareilly",cityCode:"BE"},{cityName:"Bareli",cityCode:"BEK"},{cityName:"Barddhaman",cityCode:"BWN"},{cityName:"Baripada",cityCode:"BPO"},{cityName:"Barnala",cityCode:"BNN"},{cityName:"Barrackpur",cityCode:"BP"},{cityName:"Barshi",cityCode:"BTW"},{cityName:"Vadodara (Baroda)",cityCode:"BRD"},{cityName:"Basirhat",cityCode:"BSHT"},{cityName:"Basti",cityCode:"BST"},{cityName:"Batala",cityCode:"BAT"},{cityName:"Bathinda",cityCode:"BTI"},{cityName:"Beawar",cityCode:"BER"},{cityName:"Begusarai",cityCode:"BGS"},{cityName:"Belgaum",cityCode:"IXG"},{cityName:"Bellary",cityCode:"BYC"},{cityName:"Bettiah",cityCode:"BTH"},{cityName:"Betul",cityCode:"BZU"},{cityName:"Bhadrak",cityCode:"BHC"},{cityName:"Bhadreswar",cityCode:"BHR"},{cityName:"Bhagalpur",cityCode:"BGP"},{cityName:"Bharatpur",cityCode:"BTE"},{cityName:"Bharuch",cityCode:"BH"},{cityName:"Bhatkal",cityCode:"BTJL"},{cityName:"Bhatpara",cityCode:"BHA"},{cityName:"Bhavnagar",cityCode:"BHU"},{cityName:"Bhilai",cityCode:"BIA"},{cityName:"Bhilwara",cityCode:"BHL"},{cityName:"Bhimavaram",cityCode:"BVRM"},{cityName:"Bhind",cityCode:"BIX"},{cityName:"Bhiwadi",cityCode:"BHI"},{cityName:"Bhiwandi",cityCode:"BIRD"},{cityName:"Bhiwani",cityCode:"BNWC"},{cityName:"Bhopal",cityCode:"BHO"},{cityName:"Bhubaneswar",cityCode:"BBI"},{cityName:"Bhuj",cityCode:"BHUJ"},{cityName:"Bidar",cityCode:"BIDR"},{cityName:"Bidhan Nagar",cityCode:"BNX"},{cityName:"Biharsharif",cityCode:"BEHS"},{cityName:"Bijapur",cityCode:"BJP"},{cityName:"Bikaner",cityCode:"BJKNR"},{cityName:"Bilaspur",cityCode:"BSP"},{cityName:"Bilimora",cityCode:"BIM"},{cityName:"Binsar",cityCode:"BIN"},{cityName:"Bokaro Steel",cityCode:"BKSC"},{cityName:"Bongaon",cityCode:"BNGN"},{cityName:"Botad",cityCode:"BTD"},{cityName:"Brahmapur Town",cityCode:"BAM"},{cityName:"Budaun",cityCode:"BEM"},{cityName:"Bulandshahr",cityCode:"BUL"},{cityName:"Bundi",cityCode:"BUN"},{cityName:"Burhanpur",cityCode:"BAU"},{cityName:"Buxar",cityCode:"BXR"},{cityName:"Chamarajanagar",cityCode:"CMNR"},{cityName:"Champdani",cityCode:"CHAM"},{cityName:"Chandannagar",cityCode:"CGR"},{cityName:"Chandausi",cityCode:"CH"},{cityName:"Chandrapur",cityCode:"CD"},{cityName:"Chapra",cityCode:"CPQ"},{cityName:"Chas",cityCode:"CAS"},{cityName:"Chhattarpur",cityCode:"CHH"},{cityName:"Chhindwara",cityCode:"CWA"},{cityName:"Chikmagalur",cityCode:"CHKM"},{cityName:"Chilakaluripet",cityCode:"CKT"},{cityName:"Chiplun",cityCode:"CHI"},{cityName:"Chitradurga",cityCode:"CTA"},{cityName:"Chittaurgarh",cityCode:"COR"},{cityName:"Chittoor",cityCode:"CTO"},{cityName:"Churu",cityCode:"CUR"},{cityName:"Coorg",cityCode:"CTC"},{cityName:"Cuddalore",cityCode:"COT"},{cityName:"Cuddapah",cityCode:"HX"},{cityName:"Cuttack",cityCode:"CRG"},{cityName:"Dabgram",cityCode:"DABG"},{cityName:"Dahanu Road",cityCode:"DRD"},{cityName:"Daman",cityCode:"DMN"},{cityName:"Damoh",cityCode:"DMO"},{cityName:"Darbhanga",cityCode:"DBG"},{cityName:"Darjeeling",cityCode:"DJ"},{cityName:"Datia",cityCode:"DAA"},{cityName:"Davanagere",cityCode:"DVG"},{cityName:"Dehradun",cityCode:"DDN"},{cityName:"Dehri",cityCode:"DOS"},{cityName:"Deoghar",cityCode:"DGHR"},{cityName:"Deoria",cityCode:"DEOS"},{cityName:"Dewas",cityCode:"DWX"},{cityName:"Dhamtari",cityCode:"DTR"},{cityName:"Dhanbad",cityCode:"DBN"},{cityName:"Dharamshala",cityCode:"DHAR"},{cityName:"Dharmavaram",cityCode:"DMM"},{cityName:"Dharwad",cityCode:"DWR"},{cityName:"Dhaulpur",cityCode:"DHO"},{cityName:"Dhule",cityCode:"DHI"},{cityName:"Dibba Al-Hisn",cityCode:"DAH"},{cityName:"Dibrugarh",cityCode:"DBRG"},{cityName:"Dimapur",cityCode:"DMU"},{cityName:"Dinapur Nizamat",cityCode:"DINA"},{cityName:"Dindigul",cityCode:"DG"},{cityName:"Dum Dum",cityCode:"DDJ"},{cityName:"Durg",cityCode:"DRG"},{cityName:"Durgapur",cityCode:"DGR"},{cityName:"Dwarka",cityCode:"DWK"},{cityName:"Eluru",cityCode:"EE"},{cityName:"English Bazar",cityCode:"ENG"},{cityName:"Ernakulam",cityCode:"ERS"},{cityName:"Erode",cityCode:"ED"},{cityName:"Etah",cityCode:"ETA"},{cityName:"Etawah",cityCode:"ETW"},{cityName:"Faizabad",cityCode:"FD"},{cityName:"Faridabad",cityCode:"FDB"},{cityName:"Faridkot",cityCode:"FDK"},{cityName:"Farrukhabad",cityCode:"FBD"},{cityName:"Fatehpur",cityCode:"FTP"},{cityName:"Pilibhit",cityCode:"PBE"},{cityName:"Firozabad",cityCode:"FZD"},{cityName:"Firozpur",cityCode:"FZP"},{cityName:"Gadag and Betigeri",cityCode:"GDG"},{cityName:"Gandhidham",cityCode:"GIM"},{cityName:"Gandhinagar",cityCode:"GADJ"},{cityName:"Ganganagar",cityCode:"SGNR"},{cityName:"Gangapur",cityCode:"GGC"},{cityName:"Gangavati",cityCode:"GAN"},{cityName:"Gangtok",cityCode:"GTK"},{cityName:"Gaya",cityCode:"GAYA"},{cityName:"Ghaziabad",cityCode:"GZB"},{cityName:"Ghazipur",cityCode:"GCT"},{cityName:"Giridih",cityCode:"GRD"},{cityName:"Goa",cityCode:"MAO"},{cityName:"Godhra",cityCode:"GDA"},{cityName:"Gonda",cityCode:"GD"},{cityName:"Gorakhpur",cityCode:"GKC"},{cityName:"Gudivada",cityCode:"GDV"},{cityName:"Gulbarga",cityCode:"GUL"},{cityName:"Guna",cityCode:"GUNA"},{cityName:"Guntakal",cityCode:"GTL"},{cityName:"Guntur",cityCode:"GNT"},{cityName:"Gurgaon",cityCode:"GGN"},{cityName:"Guwahati",cityCode:"GUW"},{cityName:"Gwalior",cityCode:"GWL"},{cityName:"Habra",cityCode:"HAB"},{cityName:"Hajipur",cityCode:"HJP"},{cityName:"Haldia",cityCode:"HLZ"},{cityName:"Haldwani",cityCode:"HDW"},{cityName:"Halisahar",cityCode:"HLR"},{cityName:"Hanumangarh",cityCode:"HMH"},{cityName:"Hapur",cityCode:"HPU"},{cityName:"Hardoi",cityCode:"HRI"},{cityName:"Haridwar",cityCode:"HW"},{cityName:"Hastinapur",cityCode:"HAS"},{cityName:"Hathras",cityCode:"HRS"},{cityName:"Hazaribagh",cityCode:"HAZ"},{cityName:"Himmat Nagar",cityCode:"HMT"},{cityName:"Hindaun",cityCode:"HIN"},{cityName:"Hindupur",cityCode:"HUP"},{cityName:"Hisar",cityCode:"HSR"},{cityName:"Hoshangabad",cityCode:"HSX"},{cityName:"Hoshiarpur",cityCode:"HPT"},{cityName:"Hospet",cityCode:"HOS"},{cityName:"Hosur",cityCode:"HSRA"},{cityName:"Howrah",cityCode:"HWH"},{cityName:"Hubli",cityCode:"HBX"},{cityName:"Hugli and Chinsurah",cityCode:"HAC"},{cityName:"Idukki",cityCode:"IDU"},{cityName:"Imphal",cityCode:"IMF"},{cityName:"Jabalpur",cityCode:"JBP"},{cityName:"Jagadhri",cityCode:"JAG"},{cityName:"Jagdalpur",cityCode:"JDB"},{cityName:"Jaipur",cityCode:"JAI"},{cityName:"Jaisalmer",cityCode:"JSM"},{cityName:"Jalandhar",cityCode:"JRC"},{cityName:"Jalgaon",cityCode:"JL"},{cityName:"Jalna",cityCode:"J"},{cityName:"Jalpaiguri",cityCode:"JPG"},{cityName:"Jamalpur",cityCode:"JMP"},{cityName:"Jammu",cityCode:"IXJ"},{cityName:"Jamnagar",cityCode:"JGA"},{cityName:"Jamshedpur",cityCode:"IXW"},{cityName:"Jamuria",cityCode:"JMA"},{cityName:"Jaunpur",cityCode:"JOP"},{cityName:"Jehanabad",cityCode:"JHD"},{cityName:"Jetpur Navagadh",cityCode:"JTP"},{cityName:"Jhansi",cityCode:"JHS"},{cityName:"Jhunjhunun",cityCode:"JJN"},{cityName:"Jind",cityCode:"JCY"},{cityName:"Jodhpur",cityCode:"JDH"},{cityName:"Jorhat",cityCode:"JT"},{cityName:"Junagadh",cityCode:"JNDC"},{cityName:"Kadapa",cityCode:"KDPA"},{cityName:"Kaithal",cityCode:"KLE"},{cityName:"Kakinada",cityCode:"COA"},{cityName:"Kalyani",cityCode:"KYI"},{cityName:"Kamarhati",cityCode:"KAM"},{cityName:"Kancheepuram",cityCode:"CJ"},{cityName:"Kanchrapara",cityCode:"KPA"},{cityName:"Kannur",cityCode:"CAN"},{cityName:"Kanpur",cityCode:"KNU"},{cityName:"Kanyakumari",cityCode:"CAPE"},{cityName:"Kapurthala",cityCode:"KXH"},{cityName:"Karaikudi",cityCode:"KKDI"},{cityName:"Karimnagar",cityCode:"KRMR"},{cityName:"Karnal",cityCode:"KUN"},{cityName:"Karur",cityCode:"KRR"},{cityName:"Kasargod",cityCode:"KQG"},{cityName:"Kasganj",cityCode:"KSJ"},{cityName:"Kashipur",cityCode:"KPV"},{cityName:"Kathgodam",cityCode:"KGM"},{cityName:"Katihar",cityCode:"KIR"},{cityName:"Khammam",cityCode:"KMT"},{cityName:"Khandwa",cityCode:"KNW"},{cityName:"Khanna",cityCode:"KNN"},{cityName:"Kharagpur",cityCode:"KGP"},{cityName:"Khardaha",cityCode:"KDH"},{cityName:"Khargone",cityCode:"KHA"},{cityName:"Khora",cityCode:"KHO"},{cityName:"Khor Fakkan",cityCode:"KHF"},{cityName:"Khurja",cityCode:"KJY"},{cityName:"Kishanganj",cityCode:"KNE"},{cityName:"Kishangarh",cityCode:"KSG"},{cityName:"Kolhapur",cityCode:"KOP"},{cityName:"Kolar",cityCode:"KQZ"},{cityName:"Kolhapur",cityCode:"KOP"},{cityName:"Kollam",cityCode:"QLN"},{cityName:"Korba",cityCode:"KOR"},{cityName:"Kota",cityCode:"KT"},{cityName:"Kottayam",cityCode:"KTYM"},{cityName:"Kozhikode",cityCode:"CCJ"},{cityName:"Krishnagiri",cityCode:"KNJ"},{cityName:"Krishnanagar",cityCode:"KRI"},{cityName:"Kufri",cityCode:"KFR"},{cityName:"Kulti",cityCode:"ULT"},{cityName:"Kumbakonam",cityCode:"KMU"},{cityName:"Kundapur",cityCode:"KUDA"},{cityName:"Kurnool",cityCode:"KRNT"},{cityName:"Lakhimpur",cityCode:"LKX"},{cityName:"Lalitpur",cityCode:"LAR"},{cityName:"Latur",cityCode:"LUR"},{cityName:"Loni",cityCode:"LON"},{cityName:"Ludhiana",cityCode:"LUH"},{cityName:"Machilipatnam",cityCode:"MTM"},{cityName:"Madanapalle",cityCode:"MPL"},{cityName:"Madhyamgram",cityCode:"MMG"},{cityName:"Madurai",cityCode:"IXM"},{cityName:"Mahabaleshwar",cityCode:"MHB"},{cityName:"Mahbubnagar",cityCode:"MBNR"},{cityName:"Maheshtala",cityCode:"MAH"},{cityName:"Mainpuri",cityCode:"MNQ"},{cityName:"Malappuram",cityCode:"MAL"},{cityName:"Malegoan",cityCode:"MGVK"},{cityName:"Malerkotla",cityCode:"MET"},{cityName:"Manali",cityCode:"MNL"},{cityName:"Mandsaur",cityCode:"MAND"},{cityName:"Mandya",cityCode:"MYA"},{cityName:"Mangaluru",cityCode:"IXE"},{cityName:"Mathura",cityCode:"MTJ"},{cityName:"Maunath Bhanjan",cityCode:"MAU"},{cityName:"Meerut",cityCode:"MRT"},{cityName:"Medinipur",cityCode:"MED"},{cityName:"Mahesana",cityCode:"MSH"},{cityName:"Mira",cityCode:"MRJ"},{cityName:"Mirzapur",cityCode:"MZP"},{cityName:"Modinagar",cityCode:"MDNR"},{cityName:"Moga",cityCode:"MG"},{cityName:"Mohali",cityCode:"MHL"},{cityName:"Moradabad",cityCode:"MBCT"},{cityName:"Morbi",cityCode:"MVI"},{cityName:"Morena",cityCode:"MRA"},{cityName:"Motihari",cityCode:"MCO"},{cityName:"Mount Abu",cityCode:"MTAB"},{cityName:"Muktsar",cityCode:"MKS"},{cityName:"Mughalsarai",cityCode:"MGS"},{cityName:"Munger",cityCode:"MUN"},{cityName:"Munnar",cityCode:"MNR"},{cityName:"Murwara",cityCode:"KMZ"},{cityName:"Mussoorie",cityCode:"MIE"},{cityName:"Muzaffarnagar",cityCode:"MOZ"},{cityName:"Muzaffarpur",cityCode:"MUZ"},{cityName:"Mysore",cityCode:"MYQ"},{cityName:"Nabadwip",cityCode:"NDAE"},{cityName:"Nadiad",cityCode:"NDAE"},{cityName:"Nagaon",cityCode:"NAGA"},{cityName:"Nagapattinam",cityCode:"NGT"},{cityName:"Nagaur",cityCode:"NGO"},{cityName:"Nagercoil",cityCode:"NCJ"},{cityName:"Nagpur",cityCode:"NAG"},{cityName:"Naihati",cityCode:"NH"},{cityName:"Nainital",cityCode:"NTN"},{cityName:"Nalgonda",cityCode:"NLDA"},{cityName:"Nanded",cityCode:"NDC"},{cityName:"Nandurbar",cityCode:"NNT"},{cityName:"Nandyal",cityCode:"NDL"},{cityName:"Narasaraopet",cityCode:"NRT"},{cityName:"Nashik",cityCode:"NSK"},{cityName:"Navsari",cityCode:"NVS"},{cityName:"Neemrana",cityCode:"NET"},{cityName:"Neemuch",cityCode:"NEM"},{cityName:"Nellore",cityCode:"NLR"},{cityName:"Neyveli",cityCode:"NVL"},{cityName:"Nilgiris",cityCode:"NGRD"},{cityName:"Nizamabad",cityCode:"NZB"},{cityName:"Noida",cityCode:"NOI"},{cityName:"North Barrackpur",cityCode:"NBA"},{cityName:"North Dum Dum",cityCode:"DDC"},{cityName:"Ongole",cityCode:"OGL"},{cityName:"Ooty",cityCode:"OTY"},{cityName:"Orai",cityCode:"ORA"},{cityName:"Osmanabad",cityCode:"OSM"},{cityName:"Ozhukarai",cityCode:"OZH"},{cityName:"Palakkad",cityCode:"PGT"},{cityName:"Palanpur",cityCode:"PNU"},{cityName:"Pali",cityCode:"PAL"},{cityName:"Palwal",cityCode:"PWL"},{cityName:"Panchkula",cityCode:"PAN"},{cityName:"Panihati",cityCode:"PANI"},{cityName:"Panipat",cityCode:"PNP"},{cityName:"Panvel",cityCode:"PNVL"},{cityName:"Parbhani",cityCode:"PBN"},{cityName:"Patan",cityCode:"PTN"},{cityName:"Pathankot",cityCode:"PTK"},{cityName:"Patiala",cityCode:"PTA"},{cityName:"Patna",cityCode:"PAT"},{cityName:"Perumbavoor",cityCode:"PER"},{cityName:"Pimpri and Chinchwad",cityCode:"PMP"},{cityName:"Pithampur",cityCode:"PITH"},{cityName:"Pollachi",cityCode:"POY"},{cityName:"Porbandar",cityCode:"PBR"},{cityName:"Port Blair",cityCode:"PBLAIR"},{cityName:"Proddatur",cityCode:"PX"},{cityName:"Puducherry",cityCode:"PY"},{cityName:"Pudukkottai",cityCode:"PDKT"},{cityName:"Puri Town",cityCode:"PUR"},{cityName:"Purnia",cityCode:"PRNA"},{cityName:"Puruliya",cityCode:"PRR"},{cityName:"Rae Bareli",cityCode:"RBL"},{cityName:"Raichur",cityCode:"RC"},{cityName:"Raigad",cityCode:"RIG"},{cityName:"Raiganj",cityCode:"RGJ"},{cityName:"Raigarh",cityCode:"RIG"},{cityName:"Raipur",cityCode:"R"},{cityName:"Rajahmundry",cityCode:"RJY"},{cityName:"Rajapalayam",cityCode:"RJPM"},{cityName:"Rajarhat Gopalpur",cityCode:"GPPR"},{cityName:"Rajkot",cityCode:"RAJ"},{cityName:"Rajnandgaon",cityCode:"RJN"},{cityName:"Rajpur Sonarpur",cityCode:"RPJ"},{cityName:"Ramagundam",cityCode:"RDM"},{cityName:"Ramanathapuram",cityCode:"RMD"},{cityName:"Ramnagar",cityCode:"RMR"},{cityName:"Rampur",cityCode:"RMU"},{cityName:"Ranchi",cityCode:"IXR"},{cityName:"Ranebennur",cityCode:"RANE"},{cityName:"Raniganj",cityCode:"RNG"},{cityName:"Ranikhet",cityCode:"RKT"},{cityName:"Ras al-Khaimah",cityCode:"RAK"},{cityName:"Ratlam",cityCode:"RTM"},{cityName:"Ratnagiri",cityCode:"RN"},{cityName:"Renukoot",cityCode:"RNQ"},{cityName:"Rewa",cityCode:"REWA"},{cityName:"Rewari",cityCode:"RE"},{cityName:"Rishra",cityCode:"RIS"},{cityName:"Roorkee",cityCode:"RK"},{cityName:"Rohtak",cityCode:"ROK"},{cityName:"Roorkee",cityCode:"RK"},{cityName:"Raurkela",cityCode:"ROU"},{cityName:"Rudrapur",cityCode:"RUPC"},{cityName:"Sagar",cityCode:"SAG"},{cityName:"Saharanpur",cityCode:"SRE"},{cityName:"Saharsa",cityCode:"SHC"},{cityName:"Salem",cityCode:"SA"},{cityName:"Sambhal",cityCode:"SBR"},{cityName:"Sambalpur",cityCode:"SBP"},{cityName:"Sangli",cityCode:"SLI"},{cityName:"Santipur",cityCode:"SAN"},{cityName:"Sasaram",cityCode:"SSM"},{cityName:"Satara",cityCode:"STR"},{cityName:"Satna",cityCode:"STA"},{cityName:" Sawai Madhopur",cityCode:"SWM"},{cityName:"Sehore",cityCode:"SHE"},{cityName:"Seoni",cityCode:"SEY"},{cityName:"Serampore",cityCode:"SRP"},{cityName:"Shahdol",cityCode:"SDL"},{cityName:"Shahjahanpur",cityCode:"SZP"},{cityName:"Shajapur",cityCode:"SFY"},{cityName:"Shamli",cityCode:"SMQ"},{cityName:"Shikohabad",cityCode:"SKB"},{cityName:"Shillong",cityCode:"SHL"},{cityName:"Shimla",cityCode:"SML"},{cityName:"Shivpuri",cityCode:"SVPI"},{cityName:"Siddipet",cityCode:"SOAG"},{cityName:"Sikar",cityCode:"SKIR"},{cityName:"Silchar",cityCode:"SCL"},{cityName:"Siliguri",cityCode:"SIL"},{cityName:"Silvassa",cityCode:"SLV"},{cityName:"Singrauli",cityCode:"SGRL"},{cityName:"Sitapur",cityCode:"SPC"},{cityName:"Sirsa",cityCode:"SSA"},{cityName:"Siwan",cityCode:"SV"},{cityName:"Solapur",cityCode:"SUR"},{cityName:"Sonipat",cityCode:"SNP"},{cityName:"South Dum Dum",cityCode:"DDC"},{cityName:"Srikakulam",cityCode:"CHE"},{cityName:"Srinagar",cityCode:"SXR"},{cityName:"Sujangarh",cityCode:"SUJ"},{cityName:"Sultanpur",cityCode:"SLN"},{cityName:"Sulur",cityCode:"SUU"},{cityName:"Surendranagar",cityCode:"SRGT"},{cityName:"Tadepalligudem",cityCode:"TDD"},{cityName:"Tenali",cityCode:"TEL"},{cityName:"Thanesar",cityCode:"TNDE"},{cityName:"Thanjavur",cityCode:"TJ"},{cityName:"Thiruvananthapuram",cityCode:"TRV"},{cityName:"Thrissur",cityCode:"TRC"},{cityName:"Tirunelveli",cityCode:"TEN"},{cityName:"Tirupati",cityCode:"TPTY"},{cityName:"Tiruppur",cityCode:"TUP"},{cityName:"Tiruvannamalai",cityCode:"TNM"},{cityName:"Titagarh",cityCode:"TGH"},{cityName:"Tonk",cityCode:"TONK"},{cityName:"Trichy",cityCode:"TPJ"},{cityName:"Tumkur",cityCode:"TK"},{cityName:"Thoothukkudi",cityCode:"TN"},{cityName:"Udaipur",cityCode:"UDR"},{cityName:"Udupi",cityCode:"UD"},{cityName:"Ujjain",cityCode:"UJN"},{cityName:"Ulhasnagar",cityCode:"ULNR"},{cityName:"Uluberia",cityCode:"ULB"},{cityName:"Umm al-Quwain",cityCode:"UAQ"},{cityName:"Unnao",cityCode:"ON"},{cityName:"Uttarpara Kotrung",cityCode:"UPA"},{cityName:"Valparai",cityCode:"VAL"},{cityName:"Valsad",cityCode:"BL"},{cityName:"Vapi",cityCode:"VAPI"},{cityName:"Varanasi",cityCode:"VNS"},{cityName:"Vasai-Virar",cityCode:"VAV"},{cityName:"Vellore",cityCode:"VLR"},{cityName:"Veraval",cityCode:"VRL"},{cityName:"Vidisha",cityCode:"BHS"},{cityName:"Vijayawada",cityCode:"VGA"},{cityName:"Visakhapatnam",cityCode:"VTZ"},{cityName:"Vizianagaram",cityCode:"VZM"},{cityName:"Nagda",cityCode:"NAD"},{cityName:"Warangal",cityCode:"WRN"},{cityName:"Wardha",cityCode:"WR"},{cityName:"Wayanad",cityCode:"Wayanad"},{cityName:"Yamunanagar",cityCode:"JUD"},{cityName:"Yavatmal",cityCode:"YWT"},{cityName:"Yamunanagar",cityCode:"JUD"},{cityName:"Yavatmal",cityCode:"YWT"}],a.cityNames=[],a.orgCities.forEach(function(b){a.cityNames.push(b.cityName)}),a.setAutocomplete=function(){$(".cityNames").autocomplete({source:a.cityNames,select:function(a,b){return $(".cityNames").val(b.item.value),!1},change:function(a,b){b.item||$(".cityNames").val("")},appendTo:"#autosuggest"}),$(".cityNames").focus(function(){$(this).attr("autocomplete","new-password")})},a.onCitySelection=function(){for(var b in a.form.formConfig.destinations){var c=a.form.formConfig.destinations[b];if(c.city.id==a.form.city){a.form.hotel=c.hotel.id;var d=a.form.formConfig.fields.property||"Property";a.form.context||(a.form.context={}),a.form.context[d]=c.hotel.name;var e=a.form.formConfig.fields.destination||"City";a.form.context||(a.form.context={}),a.form.context[e]=c.city.name,c.stayDays&&(a.form.dateAdd=c.stayDays),a.$$phase||a.$apply();break}}},a.onDestinationSelection=function(){for(var b in a.form.formConfig.destinations){var c=a.form.formConfig.destinations[b];if(c.hotel.id==a.form.hotel&&c.city.id==a.form.city){c.stayDays&&(a.form.dateAdd=c.stayDays);var d=a.form.formConfig.fields.property||"Property";a.form.context||(a.form.context={}),a.form.context[d]=c.hotel.name;var e=a.form.formConfig.fields.destination||"City";a.form.context||(a.form.context={}),a.form.context[e]=c.city.name,a.$$phase||a.$apply();break}}},a.hasCity=function(b){return b.city.id==a.form.city},a.skip=function(){A("Skip")},a.que=[],a.counter=0,a.hideBits=function(){a.bits=null,a.$$phase||a.$apply()},socket.emit("login",{entityID:trilyoBearer,senderID:senderID}),socket.on(trilyoBearer+".onlineTotal",function(b){if(0==totalOnlineUsers&&(totalOnlineUsers=b.count,b.count>2)){var c="";switch(b.text){case"currently":c=b.count+" "+enquirer_name+" are currently enquiring";break;default:c=b.count+" "+enquirer_name+" have enquired in past "+b.text}if(chatOpened||livewireShown||!inIframe()){if(chatOpened||!inIframe()&&!livewireShown){var d;setTimeout(function(){clearTimeout(d),a.bits={image_url:"https://chat.trilyo.com/svg/fire.png",title:c,buttons:[]};var b={};b.message={},b.message.bits=a.bits,i(b,!0),emitEvent("Nudge","Impressions",trilyoBearer+"__livewire"),a.$$phase||a.$apply(),d=setTimeout(function(){a.bits=null,a.$$phase||a.$apply()},5e3)},6e3)}}else parent.postMessage({type:"livewire",title:c},"*"),livewireShown=!0}}),socket.on(trilyoBearer+".booking",function(b){if(chatOpened){var c;emitEvent("Nudge","Impressions",trilyoBearer+"__booking"),clearTimeout(c),a.bits={image_url:"https://chat.trilyo.com/images/booking.png",title:b,buttons:[]},a.$$phase||a.$apply(),c=setTimeout(function(){a.bits=null,a.$$phase||a.$apply()},7e3)}else parent.postMessage({type:"livewire",category:"booking",title:b},"*")}),socket.on(trilyoBearer+"__"+a.userId+".typingOn",function(b){a.typing=!0,a.$$phase||a.$apply()}),socket.on(trilyoBearer+"__"+a.userId+".typingOff",function(b){a.typing=!1,a.$$phase||a.$apply()}),socket.on(trilyoBearer+"__"+a.userId+".webchat",function(b){if(b.metadata.agent){var d=b.metadata.agent.split("~~");d&&d.length>0&&d[1]&&(b.message.agent=d[1])}if(b.carousel&&(b.message.carousel=b.carousel),b.list&&(b.message.list=b.list),b.youTube&&(b.message.youTube=b.youTube),b.buttons&&(b.message=b.buttons),b.search){var e=JSON.parse(b.search);if(Object.keys(e).length>0){a.search.dataset=e.opts;for(var f=0;f<a.search.dataset.length;f++)a.search.dataset[f]&&(a.search.dataset[f].visible=!0);return!1!==e.required&&(a.modalMode=!0),a.muted||disable_sounds||audSend.play(),a.search.searchPlaceholder=e.placeholder,a.search.searchTitle=e.text,a.openSearch=!0,a.showmask=!0,o.push({chatInputMsg:"",chatOutputMsg:c.trustAsHtml(e.text),senderId:a.userId,type:"abc",plainText:e.text}),a.$$phase||a.$apply(),void(a.predictiveEnabled=!1)}}else{var g;if(b.bits)return a.bits=null,a.$$phase||a.$apply(),void setTimeout(function(){b.bits&&Object.keys(b.bits).length>1&&(clearTimeout(g),b.message.bits=b.bits,i(b,!0),g=setTimeout(function(){a.bits=null,a.$$phase||a.$apply()},5e3))},2e3);b.redirect&&a.redirectMessage(b.redirect);var j=new Date;j.setTime(j.getTime()+36e5),$.cookie(RID,!0,{expires:j,path:"/"}),fbLoaded&&fbPageId&&($(".adMessage").fadeIn(500),$(".trilyo-chat-body").css("bottom","110px")),a.que.push({data:b.message}),h()}});var B=JSON.parse(k())||[];if(B.length>0&&(startAt&&!startAt.title||!startAt)&&$.cookie(RID))for(x in B)"b"==B[x].direction?i(B[x].message,!0):A(B[x].message,void 0,!0);e(function(){a.viewModel={},a.viewModel.test="Test",a.ClintChatMessages=o,a.$$phase||a.$apply(),a.scroll(),a.enablePredictive()},500),a.$on("sendDateValue",function(a,b){A(b.dateValue)}),setTimeout(function(){inIframe(),a.loaded||n(url)},5e3),a.load=function(){a.loaded||n(url),a.loaded=!0},socket.on("connect",function(){}),setTimeout(function(){a.loaded=!1},3e4)}]).directive("owlCarousel",function(){return{restrict:"E",transclude:!1,link:function(a){a.initCarousel=function(b){var c={},d=a.$eval($(b).attr("data-options"));for(var e in d)c[e]=d[e];c.onDragged=function(){$(b).hasClass("deal-cards")&&a.emitEvent("Welcome Offer Viewed")},$(b).owlCarousel(c)}}}}).directive("owlCarouselItem",[function(){return{restrict:"A",transclude:!1,link:function(a,b){a.$last&&a.initCarousel(b.parent())}}}]).directive("starRating",[function(){return{restrict:"A",template:'<div class="rating"><span ng-repeat="star in stars"  ng-class="star" ng-click="toggle($index)"> <i class="fa fa-star-o"></i> </span></div>',scope:{ratingValue:"=",max:"=",onRatingSelected:"&"},link:function(a,b,c){var d=function(){a.stars=[];for(var b=0;b<a.max;b++)a.stars.push({filled:b<a.ratingValue})};a.toggle=function(b){a.ratingValue=b+1,a.onRatingSelected({rating:b+1})},a.$watch("ratingValue",function(a,b){b&&d()})}}}]).directive("range-slider",[function(){}]).directive("calendar",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){b.datepicker({dateFormat:"dd-M-yy",showButtonPanel:!0,buttonText:"TODAY",onSelect:function(b){a.date=b,a.$emit("sendDateValue",{dateValue:b})},minDate:new Date})}}}).directive("checkindate",function(){return{restrict:"A",link:function(a,b,c,d){b.calpicker({format:"yyyy-mm-dd",autoShow:!1,autoHide:!0,highlightedClass:"",startDate:subtractDays(new Date,"-1"),show:function(a){$(".trilyo-chat-body").css("overflow-y","hidden")},hide:function(a){$(".trilyo-chat-body").css("overflow-y","auto")},pick:function(a){var b=new Date,c=b.getDate();c<10&&(c="0"+c);var d=b.getMonth()+1;d<10&&(d="0"+d);var e=b.getFullYear(),f=new Date(e+"-"+d+"-"+c+" 00:00:00");a.date<f&&a.preventDefault()}}),cl.push(b),b.on("show.datepicker",function(){})}}}).directive("checkoutdate",function(){return{restrict:"A",link:function(a,b,c,d){var e=function(){"null"==c.monitor&&(c.monitor=null),a.watchersList.indexOf("checkout")>-1&&!c.monitor&&c.monitor&&a.watchersList.indexOf(c.monitor)>-1||a.$watch(function(a){return c.monitor?a.genericForm.data[c.monitor]:a.form.checkin},function(b,d){if(c.monitor?a.watchersList.push(c.monitor):a.watchersList.push("checkout"),a.checkoutpicker){var e=a.form.dateAdd;if(e&&b){var f=new Date(b);return a.checkoutpicker.setDate(subtractDays(f,-e)),void(!c.monitor&&a.form.init.maxStay&&a.checkoutpicker.setEndDate(subtractDays(f,-a.form.init.maxStay)))}b&&!a.form.checkout&&(!a.form.init||a.form.init&&!a.form.init.checkin)||b&&a.form.checkout&&new Date(a.form.checkout)<=new Date(b)?b&&(a.checkoutpicker.setFormat("yyyy-mm-dd"),a.checkoutpicker.setDate(subtractDays(new Date(b),-1)),a.checkoutpicker.setAutoHide(!0),a.checkoutpicker.setStartDate(subtractDays(new Date(b),-1)),!c.monitor&&a.form.formConfig.maxStay&&a.checkoutpicker.setEndDate(subtractDays(new Date(b),-a.form.formConfig.maxStay)),a.checkoutpicker.pick(),a.checkoutpicker.show()):b&&(a.checkoutpicker.setStartDate(subtractDays(new Date(b),-1)),a.form.formConfig.maxStay&&a.checkoutpicker.setEndDate(subtractDays(new Date(b),-a.form.formConfig.maxStay)),a.checkoutpicker.setDate(subtractDays(new Date(b),-1)),a.checkoutpicker.setAutoHide(!0),a.checkoutpicker.pick())}})};!function(c,d,f){d=d||!1,c||(c=new Date),b.calpicker({format:"yyyy-mm-dd",autoShow:d,startDate:c,endDate:f,autoHide:!0,highlightedClass:"",show:function(a){$(".trilyo-chat-body").css("overflow-y","hidden")},hide:function(a){$(".trilyo-chat-body").css("overflow-y","auto")},pick:function(a){var b=new Date,c=b.getDate();c<10&&(c="0"+c);var d=b.getMonth()+1;d<10&&(d="0"+d);var e=b.getFullYear(),f=new Date(e+"-"+d+"-"+c+" 00:00:00");a.date<f&&a.preventDefault()},cb:function(b){a.checkoutpicker=b,e()}}),cl.push(b)}()}}}).directive("timepicker",function(){return{restrict:"A",link:function(a,b,c,d){b.wickedpicker({title:"Choose time"})}}}).directive("geocode",function(){return{restrict:"A",link:function(a,b,c,d){var e=new google.maps.places.Autocomplete(b.get(0),{types:["(cities)"],fields:["name","geometry.location","place_id","formatted_address","address_components"]});e.addListener("place_changed",function(){placeInfo=e.getPlace(),Object.keys(placeInfo).length>1?(a.selectGeoLocation(placeInfo),a.locationError=!1,a.$$phase||a.$apply()):(a.locationError=!0,a.$$phase||a.$apply())})}}}).directive("geocodeany",function(){return{restrict:"A",link:function(a,b,c,d){var e=c.geocodeany.split(":");if(e[1])var f=e[1];var g=new google.maps.places.Autocomplete(b.get(0),{fields:["name","geometry.location","place_id","formatted_address","address_components"]});f&&g.setComponentRestrictions({country:f.split(",")}),g.addListener("place_changed",function(){placeInfo=g.getPlace(),Object.keys(placeInfo).length>1?(a.selectGeoLocation(placeInfo),a.locationError=!1,a.$$phase||a.$apply()):(a.locationError=!0,a.$$phase||a.$apply())})}}}).directive("ngFocus",["$timeout",function(a){return{link:function(b,c,d){b.$watch(d.ngFocus,function(b){angular.isDefined(b)&&b&&a(function(){c[0].focus()})},!0),c.bind("blur",function(){angular.isDefined(d.ngFocusLost)&&b.$apply(d.ngFocusLost)})}}}]).directive("numbersOnly",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.push(function(b){if(void 0==b)return"";var c=b.replace(/[^0-9]/g,"");return c!=b&&(d.$setViewValue(c),d.$render()),""==c&&(a.numericError=!0),c})}}}).directive("intltelinput",function(){return{restrict:"A",link:function(a,b,c,d){var e=c.intltelinput||default_country;b.intlTelInput({initialCountry:e})}}}).filter("startFrom",function(){return function(a,b){return a?(b=+b,a.slice(b)):[]}}).filter("strLimit",["$filter",function(a){return function(b,c){if(b)return b.length<=c?b:a("limitTo")(b,c)+"..."}}]).filter("trustAsResourceUrl",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b)}}]);var Capitalize=function(a){if(a)return a.substring(0,1).toUpperCase()+a.substring(1)};